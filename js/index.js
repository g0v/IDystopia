!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=12)}([function(t,e,i){"undefined"==typeof DEBUG&&(DEBUG=!0);var n=i(4),s=i(5),r=i(6),o=i(17);function a(t){if(!(this instanceof a))return r.fn(t)?a.app.apply(a,arguments):r.object(t)?a.atlas.apply(a,arguments):t;n.create++;for(var e=0;e<h.length;e++)h[e].call(this)}n.create=0;var h=[];a._init=function(t){h.push(t)};var c=[];a._load=function(t){c.push(t)};var u={};a.config=function(){if(1===arguments.length&&r.string(arguments[0]))return u[arguments[0]];1===arguments.length&&r.object(arguments[0])&&s(u,arguments[0]),2===arguments.length&&r.string(arguments[0])};var l=[],f=[],p=!1,d=!1;a.app=function(t,e){if(p){DEBUG&&console.log("Creating app...");var i=a.config("app-loader");i((function(e,i){DEBUG&&console.log("Initing app...");for(var n=0;n<c.length;n++)c[n].call(this,e,i);t(e,i),f.push(e),DEBUG&&console.log("Starting app..."),e.start()}),e)}else l.push(arguments)};var _=o();a.preload=function(t){if("string"==typeof t){var e=a.resolve(t);/\.js($|\?|\#)/.test(e)&&(DEBUG&&console.log("Loading script: "+e),t=function(t){!function(t,e){var i=document.createElement("script");i.addEventListener("load",(function(){e()})),i.addEventListener("error",(function(i){e(i||"Error loading script: "+t)})),i.src=t,i.id="preload-"+Date.now(),document.body.appendChild(i)}(e,t)})}"function"==typeof t&&t(_())},a.start=function(t){DEBUG&&console.log("Starting..."),a.config(t),_.then((function(){for(DEBUG&&console.log("Loading apps..."),p=!0;l.length;){var t=l.shift();a.app.apply(a,t)}}))},a.pause=function(){if(!d){d=!0;for(var t=f.length-1;t>=0;t--)f[t].pause()}},a.resume=function(){if(d){d=!1;for(var t=f.length-1;t>=0;t--)f[t].resume()}},a.create=function(){return new a},a.resolve=function(){if("undefined"==typeof window||"undefined"==typeof document)return function(t){return t};var t=document.getElementsByTagName("script");return function(e){if(/^\.\//.test(e)){var i=function(){if(document.currentScript)return document.currentScript.src;var e;try{var i=new Error;if(!i.stack)throw i;e=i.stack}catch(i){e=i.stack}if("string"==typeof e)for(var n=(e=e.split("\n")).length;n--;){var s=e[n].match(/(\w+\:\/\/[^/]*?\/.+?)(:\d+)(:\d+)?/);if(s)return s[1]}if(t.length&&"readyState"in t[0])for(n=t.length;n--;)if("interactive"===t[n].readyState)return t[n].src;return location.href}();e=i.substring(0,i.lastIndexOf("/")+1)+e.substring(2)}return e}}(),t.exports=a},function(t,e){if("function"==typeof Object.create)t.exports=function(t,e){return Object.create.call(Object,t,e)};else{function i(){}t.exports=function(t,e){if(e)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");return i.prototype=t,new i}}},function(t,e,i){var n=i(0),s=i(10),r=0;function o(t){this._owner=t,this._parent=null,this._relativeMatrix=new s,this._absoluteMatrix=new s,this.reset()}n._init((function(){this._pin=new o(this)})),n.prototype.matrix=function(t){return!0===t?this._pin.relativeMatrix():this._pin.absoluteMatrix()},n.prototype.pin=function(t,e){return"object"==typeof t?(this._pin.set(t),this):"string"==typeof t?void 0===e?this._pin.get(t):(this._pin.set(t,e),this):void 0===t?this._pin:void 0},o.prototype.reset=function(){this._textureAlpha=1,this._alpha=1,this._width=0,this._height=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._rotation=0,this._pivoted=!1,this._pivotX=null,this._pivotY=null,this._handled=!1,this._handleX=0,this._handleY=0,this._aligned=!1,this._alignX=0,this._alignY=0,this._offsetX=0,this._offsetY=0,this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height,this._ts_translate=++r,this._ts_transform=++r,this._ts_matrix=++r},o.prototype._update=function(){return this._parent=this._owner._parent&&this._owner._parent._pin,this._handled&&this._mo_handle!=this._ts_transform&&(this._mo_handle=this._ts_transform,this._ts_translate=++r),this._aligned&&this._parent&&this._mo_align!=this._parent._ts_transform&&(this._mo_align=this._parent._ts_transform,this._ts_translate=++r),this},o.prototype.toString=function(){return this._owner+" ("+(this._parent?this._parent._owner:null)+")"},o.prototype.absoluteMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_matrix:0);if(this._mo_abs==t)return this._absoluteMatrix;this._mo_abs=t;var e=this._absoluteMatrix;return e.reset(this.relativeMatrix()),this._parent&&e.concat(this._parent._absoluteMatrix),this._ts_matrix=++r,e},o.prototype.relativeMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_transform:0);if(this._mo_rel==t)return this._relativeMatrix;this._mo_rel=t;var e,i,n=this._relativeMatrix;(n.identity(),this._pivoted&&n.translate(-this._pivotX*this._width,-this._pivotY*this._height),n.scale(this._scaleX,this._scaleY),n.skew(this._skewX,this._skewY),n.rotate(this._rotation),this._pivoted&&n.translate(this._pivotX*this._width,this._pivotY*this._height),this._pivoted)?(this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height):(n.a>0&&n.c>0||n.a<0&&n.c<0?(e=0,i=n.a*this._width+n.c*this._height):(e=n.a*this._width,i=n.c*this._height),e>i?(this._boxX=i,this._boxWidth=e-i):(this._boxX=e,this._boxWidth=i-e),n.b>0&&n.d>0||n.b<0&&n.d<0?(e=0,i=n.b*this._width+n.d*this._height):(e=n.b*this._width,i=n.d*this._height),e>i?(this._boxY=i,this._boxHeight=e-i):(this._boxY=e,this._boxHeight=i-e));return this._x=this._offsetX,this._y=this._offsetY,this._x-=this._boxX+this._handleX*this._boxWidth,this._y-=this._boxY+this._handleY*this._boxHeight,this._aligned&&this._parent&&(this._parent.relativeMatrix(),this._x+=this._alignX*this._parent._width,this._y+=this._alignY*this._parent._height),n.translate(this._x,this._y),this._relativeMatrix},o.prototype.get=function(t){if("function"==typeof a[t])return a[t](this)},o.prototype.set=function(t,e){if("string"==typeof t)"function"==typeof h[t]&&void 0!==e&&h[t](this,e);else if("object"==typeof t)for(e in t)"function"==typeof h[e]&&void 0!==t[e]&&h[e](this,t[e],t);return this._owner&&(this._owner._ts_pin=++r,this._owner.touch()),this};var a={alpha:function(t){return t._alpha},textureAlpha:function(t){return t._textureAlpha},width:function(t){return t._width},height:function(t){return t._height},boxWidth:function(t){return t._boxWidth},boxHeight:function(t){return t._boxHeight},scaleX:function(t){return t._scaleX},scaleY:function(t){return t._scaleY},skewX:function(t){return t._skewX},skewY:function(t){return t._skewY},rotation:function(t){return t._rotation},pivotX:function(t){return t._pivotX},pivotY:function(t){return t._pivotY},offsetX:function(t){return t._offsetX},offsetY:function(t){return t._offsetY},alignX:function(t){return t._alignX},alignY:function(t){return t._alignY},handleX:function(t){return t._handleX},handleY:function(t){return t._handleY}},h={alpha:function(t,e){t._alpha=e},textureAlpha:function(t,e){t._textureAlpha=e},width:function(t,e){t._width_=e,t._width=e,t._ts_transform=++r},height:function(t,e){t._height_=e,t._height=e,t._ts_transform=++r},scale:function(t,e){t._scaleX=e,t._scaleY=e,t._ts_transform=++r},scaleX:function(t,e){t._scaleX=e,t._ts_transform=++r},scaleY:function(t,e){t._scaleY=e,t._ts_transform=++r},skew:function(t,e){t._skewX=e,t._skewY=e,t._ts_transform=++r},skewX:function(t,e){t._skewX=e,t._ts_transform=++r},skewY:function(t,e){t._skewY=e,t._ts_transform=++r},rotation:function(t,e){t._rotation=e,t._ts_transform=++r},pivot:function(t,e){t._pivotX=e,t._pivotY=e,t._pivoted=!0,t._ts_transform=++r},pivotX:function(t,e){t._pivotX=e,t._pivoted=!0,t._ts_transform=++r},pivotY:function(t,e){t._pivotY=e,t._pivoted=!0,t._ts_transform=++r},offset:function(t,e){t._offsetX=e,t._offsetY=e,t._ts_translate=++r},offsetX:function(t,e){t._offsetX=e,t._ts_translate=++r},offsetY:function(t,e){t._offsetY=e,t._ts_translate=++r},align:function(t,e){this.alignX(t,e),this.alignY(t,e)},alignX:function(t,e){t._alignX=e,t._aligned=!0,t._ts_translate=++r,this.handleX(t,e)},alignY:function(t,e){t._alignY=e,t._aligned=!0,t._ts_translate=++r,this.handleY(t,e)},handle:function(t,e){this.handleX(t,e),this.handleY(t,e)},handleX:function(t,e){t._handleX=e,t._handled=!0,t._ts_translate=++r},handleY:function(t,e){t._handleY=e,t._handled=!0,t._ts_translate=++r},resizeMode:function(t,e,i){i&&("in"==e?e="in-pad":"out"==e&&(e="out-crop"),c(t,i.resizeWidth,i.resizeHeight,e))},resizeWidth:function(t,e,i){i&&i.resizeMode||c(t,e,null)},resizeHeight:function(t,e,i){i&&i.resizeMode||c(t,null,e)},scaleMode:function(t,e,i){i&&c(t,i.scaleWidth,i.scaleHeight,e)},scaleWidth:function(t,e,i){i&&i.scaleMode||c(t,e,null)},scaleHeight:function(t,e,i){i&&i.scaleMode||c(t,null,e)},matrix:function(t,e){this.scaleX(t,e.a),this.skewX(t,e.c/e.d),this.skewY(t,e.b/e.a),this.scaleY(t,e.d),this.offsetX(t,e.e),this.offsetY(t,e.f),this.rotation(t,0)}};function c(t,e,i,n){var s="number"==typeof e,o="number"==typeof i,a="string"==typeof n;t._ts_transform=++r,s&&(t._scaleX=e/t._width_,t._width=t._width_),o&&(t._scaleY=i/t._height_,t._height=t._height_),s&&o&&a&&("out"==n||"out-crop"==n?t._scaleX=t._scaleY=Math.max(t._scaleX,t._scaleY):"in"!=n&&"in-pad"!=n||(t._scaleX=t._scaleY=Math.min(t._scaleX,t._scaleY)),"out-crop"!=n&&"in-pad"!=n||(t._width=e/t._scaleX,t._height=i/t._scaleY))}n.prototype.scaleTo=function(t,e,i){return"object"==typeof t&&(i=e,e=t.y,t=t.x),c(this._pin,t,e,i),this},o._add_shortcuts=function(t){t.prototype.size=function(t,e){return this.pin("width",t),this.pin("height",e),this},t.prototype.width=function(t){return void 0===t?this.pin("width"):(this.pin("width",t),this)},t.prototype.height=function(t){return void 0===t?this.pin("height"):(this.pin("height",t),this)},t.prototype.offset=function(t,e){return"object"==typeof t&&(e=t.y,t=t.x),this.pin("offsetX",t),this.pin("offsetY",e),this},t.prototype.rotate=function(t){return this.pin("rotation",t),this},t.prototype.skew=function(t,e){return"object"==typeof t?(e=t.y,t=t.x):void 0===e&&(e=t),this.pin("skewX",t),this.pin("skewY",e),this},t.prototype.scale=function(t,e){return"object"==typeof t?(e=t.y,t=t.x):void 0===e&&(e=t),this.pin("scaleX",t),this.pin("scaleY",e),this},t.prototype.alpha=function(t,e){return this.pin("alpha",t),void 0!==e&&this.pin("textureAlpha",e),this}},o._add_shortcuts(n),t.exports=o},function(t,e,i){var n=i(0);i(2);var s=i(4);n.prototype._textures=null,n.prototype._alpha=1,n.prototype.render=function(t){if(this._visible){s.node++;var e=this.matrix();t.setTransform(e.a,e.b,e.c,e.d,e.e,e.f),this._alpha=this._pin._alpha*(this._parent?this._parent._alpha:1);var i=this._pin._textureAlpha*this._alpha;if(t.globalAlpha!=i&&(t.globalAlpha=i),null!==this._textures)for(var n=0,r=this._textures.length;n<r;n++)this._textures[n].draw(t);t.globalAlpha!=this._alpha&&(t.globalAlpha=this._alpha);for(var o,a=this._first;o=a;)a=o._next,o.render(t)}},n.prototype._tickBefore=null,n.prototype._tickAfter=null,n.prototype.MAX_ELAPSE=1/0,n.prototype._tick=function(t,e,i){if(this._visible){t>this.MAX_ELAPSE&&(t=this.MAX_ELAPSE);var n=!1;if(null!==this._tickBefore)for(var r=0;r<this._tickBefore.length;r++){s.tick++,n=!0===this._tickBefore[r].call(this,t,e,i)||n}for(var o,a=this._first;o=a;)a=o._next,o._flag("_tick")&&(n=!0===o._tick(t,e,i)||n);if(null!==this._tickAfter)for(r=0;r<this._tickAfter.length;r++){s.tick++,n=!0===this._tickAfter[r].call(this,t,e,i)||n}return n}},n.prototype.tick=function(t,e){"function"==typeof t&&(e?(null===this._tickBefore&&(this._tickBefore=[]),this._tickBefore.push(t)):(null===this._tickAfter&&(this._tickAfter=[]),this._tickAfter.push(t)),this._flag("_tick",null!==this._tickAfter&&this._tickAfter.length>0||null!==this._tickBefore&&this._tickBefore.length>0))},n.prototype.untick=function(t){var e;"function"==typeof t&&(null!==this._tickBefore&&(e=this._tickBefore.indexOf(t))>=0&&this._tickBefore.splice(e,1),null!==this._tickAfter&&(e=this._tickAfter.indexOf(t))>=0&&this._tickAfter.splice(e,1))},n.prototype.timeout=function(t,e){this.setTimeout(t,e)},n.prototype.setTimeout=function(t,e){function i(n){if(!((e-=n)<0))return!0;this.untick(i),t.call(this)}return this.tick(i),i},n.prototype.clearTimeout=function(t){this.untick(t)}},function(t,e){t.exports={}},function(t,e){t.exports=function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}return t}},function(t,e){
/**
 * ! is the definitive JavaScript type testing library
 * 
 * @copyright 2013-2014 Enrico Marino / Jordan Harband
 * @license MIT
 */
var i=Object.prototype,n=i.hasOwnProperty,s=i.toString,r=/^[A-Fa-f0-9]+$/,o=t.exports={};o.a=o.an=o.type=function(t,e){return typeof t===e},o.defined=function(t){return void 0!==t},o.empty=function(t){var e,i=s.call(t);if("[object Array]"===i||"[object Arguments]"===i||"[object String]"===i)return 0===t.length;if("[object Object]"===i){for(e in t)if(n.call(t,e))return!1;return!0}return!t},o.equal=function(t,e){if(t===e)return!0;var i,n=s.call(t);if(n!==s.call(e))return!1;if("[object Object]"===n){for(i in t)if(!o.equal(t[i],e[i])||!(i in e))return!1;for(i in e)if(!o.equal(t[i],e[i])||!(i in t))return!1;return!0}if("[object Array]"===n){if((i=t.length)!==e.length)return!1;for(;--i;)if(!o.equal(t[i],e[i]))return!1;return!0}return"[object Function]"===n?t.prototype===e.prototype:"[object Date]"===n&&t.getTime()===e.getTime()},o.instance=function(t,e){return t instanceof e},o.nil=function(t){return null===t},o.undef=function(t){return void 0===t},o.array=function(t){return"[object Array]"===s.call(t)},o.emptyarray=function(t){return o.array(t)&&0===t.length},o.arraylike=function(t){return!!t&&!o.boolean(t)&&n.call(t,"length")&&isFinite(t.length)&&o.number(t.length)&&t.length>=0},o.boolean=function(t){return"[object Boolean]"===s.call(t)},o.element=function(t){return void 0!==t&&"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&1===t.nodeType},o.fn=function(t){return"[object Function]"===s.call(t)},o.number=function(t){return"[object Number]"===s.call(t)},o.nan=function(t){return!o.number(t)||t!=t},o.object=function(t){return"[object Object]"===s.call(t)},o.hash=function(t){return o.object(t)&&t.constructor===Object&&!t.nodeType&&!t.setInterval},o.regexp=function(t){return"[object RegExp]"===s.call(t)},o.string=function(t){return"[object String]"===s.call(t)},o.hex=function(t){return o.string(t)&&(!t.length||r.test(t))}},function(t,e,i){"use strict";i.r(e),i.d(e,"LocalStorage",(function(){return s})),i.d(e,"RemoteStorage",(function(){return r})),i.d(e,"AnswerStore",(function(){return o}));const n=i(13);!function(t){const e=[];t.fn("setAndNotify",(function(t,e){if(this.set(t,e),this.callbacks){if(this.callbacks.hasOwnProperty(t))for(const e of this.callbacks[t])e.call(this,t);if(this.callbacks.hasOwnProperty("*"))for(const e of this.callbacks["*"])e.call(this,t)}})),t.fn("notify",(function(){for(const t in e)if(this.callbacks.hasOwnProperty(t))for(const e of this.callbacks[t])e.call(this)})),t.fn("listen",(function(t,e){void 0===this.callbacks&&(this.callbacks={}),void 0===this.callbacks[t]&&(this.callbacks[t]=[]),this.callbacks[t].push(e)}))}(n._);class s{constructor(){}}class r{}const o=n.namespace("DIALOG_ANSWER")},function(t,e,i){var n=i(4),s=i(9);function r(t,e){"object"==typeof t&&this.src(t,e)}r.prototype.pipe=function(){return new r(this)},r.prototype.src=function(t,e,i,n){if("object"==typeof t){var s=t,r=e||1;this._image=s,this._sx=this._dx=0,this._sy=this._dy=0,this._sw=this._dw=s.width/r,this._sh=this._dh=s.height/r,this.width=s.width/r,this.height=s.height/r,this.ratio=r}else void 0===i?(i=t,n=e):(this._sx=t,this._sy=e),this._sw=this._dw=i,this._sh=this._dh=n,this.width=i,this.height=n;return this},r.prototype.dest=function(t,e,i,n){return this._dx=t,this._dy=e,this._dx=t,this._dy=e,void 0!==i&&(this._dw=i,this._dh=n,this.width=i,this.height=n),this},r.prototype.draw=function(t,e,i,r,o,a,h,c,u){var l=this._image;if(null!==l&&"object"==typeof l){var f=this._sx,p=this._sy,d=this._sw,_=this._sh,g=this._dx,m=this._dy,y=this._dw,v=this._dh;void 0!==a?(e=s.limit(e,0,this._sw),r=s.limit(r,0,this._sw-e),f+=e,p+=i=s.limit(i,0,this._sh),d=r,_=o=s.limit(o,0,this._sh-i),g=a,m=h,y=c,v=u):void 0!==r?(g=e,m=i,y=r,v=o):void 0!==e&&(y=e,v=i);var x=this.ratio||1;f*=x,p*=x,d*=x,_*=x;try{"function"==typeof l.draw?l.draw(t,f,p,d,_,g,m,y,v):(n.draw++,t.drawImage(l,f,p,d,_,g,m,y,v))}catch(t){l._draw_failed||(console.log("Unable to draw: ",l),console.log(t),l._draw_failed=!0)}}},t.exports=r},function(t,e,i){var n=i(1),s=Math;t.exports=n(Math),t.exports.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:s.random()*(e-t)+t},t.exports.rotate=function(t,e,i){return void 0===e?(i=1,e=0):void 0===i&&(i=e,e=0),i>e?(t=(t-e)%(i-e))+(t<0?i:e):(t=(t-i)%(e-i))+(t<=0?e:i)},t.exports.limit=function(t,e,i){return t<e?e:t>i?i:t},t.exports.length=function(t,e){return s.sqrt(t*t+e*e)}},function(t,e){function i(t,e,i,n,s,r){this.reset(t,e,i,n,s,r)}i.prototype.toString=function(){return"["+this.a+", "+this.b+", "+this.c+", "+this.d+", "+this.e+", "+this.f+"]"},i.prototype.clone=function(){return new i(this.a,this.b,this.c,this.d,this.e,this.f)},i.prototype.reset=function(t,e,i,n,s,r){return this._dirty=!0,"object"==typeof t?(this.a=t.a,this.d=t.d,this.b=t.b,this.c=t.c,this.e=t.e,this.f=t.f):(this.a=t||1,this.d=n||1,this.b=e||0,this.c=i||0,this.e=s||0,this.f=r||0),this},i.prototype.identity=function(){return this._dirty=!0,this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this},i.prototype.rotate=function(t){if(!t)return this;this._dirty=!0;var e=t?Math.cos(t):1,i=t?Math.sin(t):0,n=e*this.a-i*this.b,s=e*this.b+i*this.a,r=e*this.c-i*this.d,o=e*this.d+i*this.c,a=e*this.e-i*this.f,h=e*this.f+i*this.e;return this.a=n,this.b=s,this.c=r,this.d=o,this.e=a,this.f=h,this},i.prototype.translate=function(t,e){return t||e?(this._dirty=!0,this.e+=t,this.f+=e,this):this},i.prototype.scale=function(t,e){return t-1||e-1?(this._dirty=!0,this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this):this},i.prototype.skew=function(t,e){if(!t&&!e)return this;this._dirty=!0;var i=this.a+this.b*t,n=this.b+this.a*e,s=this.c+this.d*t,r=this.d+this.c*e,o=this.e+this.f*t,a=this.f+this.e*e;return this.a=i,this.b=n,this.c=s,this.d=r,this.e=o,this.f=a,this},i.prototype.concat=function(t){this._dirty=!0;var e=this,i=e.a*t.a+e.b*t.c,n=e.b*t.d+e.a*t.b,s=e.c*t.a+e.d*t.c,r=e.d*t.d+e.c*t.b,o=e.e*t.a+t.e+e.f*t.c,a=e.f*t.d+t.f+e.e*t.b;return this.a=i,this.b=n,this.c=s,this.d=r,this.e=o,this.f=a,this},i.prototype.inverse=i.prototype.reverse=function(){if(this._dirty){this._dirty=!1,this.inversed=this.inversed||new i;var t=this.a*this.d-this.b*this.c;this.inversed.a=this.d/t,this.inversed.b=-this.b/t,this.inversed.c=-this.c/t,this.inversed.d=this.a/t,this.inversed.e=(this.c*this.f-this.e*this.d)/t,this.inversed.f=(this.e*this.b-this.a*this.f)/t}return this.inversed},i.prototype.map=function(t,e){return(e=e||{}).x=this.a*t.x+this.c*t.y+this.e,e.y=this.b*t.x+this.d*t.y+this.f,e},i.prototype.mapX=function(t,e){return"object"==typeof t&&(e=t.y,t=t.x),this.a*t+this.c*e+this.e},i.prototype.mapY=function(t,e){return"object"==typeof t&&(e=t.y,t=t.x),this.b*t+this.d*e+this.f},t.exports=i},function(t,e,i){"use strict";i.r(e),i.d(e,"DialogItemLine",(function(){return c})),i.d(e,"DialogItemSelect",(function(){return u})),i.d(e,"DialogItemPrompt",(function(){return l})),i.d(e,"DialogItemMessage",(function(){return f})),i.d(e,"loadStoryLine",(function(){return p}));const n=i(7);class s{constructor(t,e,i,n,s){this.id=t,this.title=e,this.description=i,this.depend=n,this.firstStep=s,this.steps={}}addStep(t){this.steps[t.id]=t}isReady(){if(console.log("checking dependency of "+this.id),!this.depend)return!0;for(const t in this.depend){const e=this.depend[t];let i,s;if(console.log("condition: ",e),"string"==typeof e?i=e:"object"==typeof e&&(i=e.storeKey,s=e.value),!n.AnswerStore.has(i))return!1;if(!s)continue;if(n.AnswerStore.get(i)!==s)return!1}return console.log(this.id+" is ready!"),!0}static fromDict(t,e){const i=e.title||"Unnamed Mission",n=e.description||"no description",o=e.firstStep||"step-1",a=(e.depend||[]).filter(t=>"string"==typeof t||t instanceof String||("object"==typeof t||(console.warn(t+" is not a string nor an object"),!1))),h=new s(t,i,n,a,o);for(const t in e.steps){const i=r.fromDict(t,e.steps[t],h);h.addStep(i)}return h}}class r{constructor({id:t,title:e,description:i,nextStep:n,npcId:s,dialog:r,mission:o,moveTo:a}){this.id=t,this.title=e||"Unnamed Step",this.description=i||"...",this.nextStep=n,this.npcId=s,this.dialog=r,this.mission=o,this.moveTo=a}static fromDict(t,e,i){const n={id:t,mission:i,...e},s=new r(n),a=o.fromDict(e.dialog||[],s);return s.dialog=a,s}}class o{constructor(t){this.missionStep=t,this.dialogItems=[],this.dialogIdMap={}}addDialogItem(t){this.dialogItems.push(t),void 0!==t.id&&(this.dialogIdMap[t.id]=this.dialogItems.length-1)}getIterator(){return new a(this,this.missionStep.nextStep)}static fromDict(t,e){const i=new o(e);for(const e of t){const t=h.fromDict(e);i.addDialogItem(t)}return i}}class a{constructor(t,e){this.dialog=t,this.currentIndex=0,this.nextStep=e}getCurrentDialogItem(){const t=this.dialog.dialogItems[this.currentIndex];return t&&t.nextStep&&(this.nextStep=t.nextStep),t}nextDialogItem(t){const e=this.dialog.dialogItems[this.currentIndex];let i=this.currentIndex+1;if(void 0!==e.nextLine&&(i=this.dialog.dialogIdMap[e.nextLine]),e instanceof u&&(void 0===t&&(console.warn("This is a multiple choice question, but no selected answer. Default to the first answer."),t=0),void 0!==e.choices[t].nextLine)){const n=e.choices[t].nextLine;i=this.dialog.dialogIdMap[n]}if(e instanceof l&&e.storeKey&&n.AnswerStore.setAndNotify(e.storeKey,t),e instanceof u){const i=e.choices[t].value||t;e.storeKey&&n.AnswerStore.setAndNotify(e.storeKey,i)}return console.info(`${this.dialog.missionStep.id} The next line is: ${i}`),this.currentIndex=i,this.getCurrentDialogItem()}}class h{constructor(t,{id:e,nextLine:i}){this.name=t,this.id=e,this.nextLine=i}static fromDict(t){const e=t.name||"John Doe",i=t.type||"line";switch(i){case"line":return new c(e,t);case"input.select":return new u(e,t);case"input.text":return new l(e,t);case"message":return new f(e,t);default:return console.warn("unkonwn dialog type: %s",i),new c(e,t)}}}class c extends h{constructor(t,{id:e,nextLine:i,line:n}){super(t,{id:e,nextLine:i}),void 0===n&&(console.warn("One of `line` and `question` should be defined."),n="..."),this.line=n}}class u extends h{constructor(t,{id:e,nextLine:i,question:n,choices:s,storeKey:r}){super(t,{id:e,nextLine:i}),void 0===n&&(console.warn("set default question"),n="Please select an answer."),this.question=n,void 0!==s&&s||(console.warn("set default choices"),s=[{text:"Ok"}]),this.choices=s,this.storeKey=r}}class l extends h{constructor(t,{id:e,nextLine:i,question:n,storeKey:s}){super(t,{id:e,nextLine:i}),void 0===n&&(console.warn("set deafult question"),n="What do you want to share?"),this.question=n,this.storeKey=s}}class f extends h{constructor(t,{id:e,nextLine:i,message:n}){super(t,{id:e,nextLine:i}),void 0===n&&(console.warn("use default message"),n="MESSAGE"),this.message=n}}async function p(t){const e=await fetch("/story-lines/"+t),i=(await e.json()).missions,n={};if(!i)return n;for(const t in i){const e=i[t];n[t]=s.fromDict(t,e)}return console.log(n),n}},function(t,e,i){const n=i(7),s=i(14),r=i(11),o={type:Phaser.AUTO,width:800,height:600,parent:"game-container",pixelArt:!0,physics:{default:"arcade",arcade:{gravity:{y:0}}},scene:{preload:function(){this.load.setPath("assets/"),this.load.image("tiles","tiles/world.png"),this.load.tilemapTiledJSON("map","maps/idystopia.json"),this.load.atlas("atlas","atlas/atlas.png","atlas/atlas.json")},create:function(){const t=this.make.tilemap({key:"map"}),e=t.addTilesetImage("world","tiles"),i=(t.createStaticLayer("Below Player",e,0,0),t.createStaticLayer("World",e,0,0)),o=t.createStaticLayer("Above Player",e,0,0);i.setCollisionByProperty({collides:!0}),o.setDepth(10);const c=t.findObject("Objects",t=>"Spawn Point"===t.name);this.charDaemon=new s.CharDaemon(this);const u={"convenient-store-npc":{name:"便利商店店員",x:c.x+128,y:c.y-128,texture:"atlas",frame:"misa-left"},"classmate-npc":{name:"同學",x:600,y:550,texture:"atlas",frame:"misa-left"},"academic-affairs-officer-npc":{name:"教務處職員",x:700,y:550,texture:"atlas",frame:"misa-left"},"department-officer-npc":{name:"系辦公室職員",x:800,y:550,texture:"atlas",frame:"misa-right"},"home-robot-npc":{name:"家用機器人",x:400,y:550,texture:"atlas",frame:"misa-right"}};for(const t in u){if(!u.hasOwnProperty(t))continue;const{name:e,x:i,y:n,texture:s,frame:r}=u[t];this.charDaemon.create(t,e,i,n,s,r)}const l=this.charDaemon.create("player","???",c.x,c.y,"atlas","misa-front");h=l.player;const f=this.physics.add.group();for(const t in this.charDaemon.chars)if(this.charDaemon.chars.hasOwnProperty(t)){const e=this.charDaemon.chars[t].player;f.add(e),"player"!==t&&e.setImmovable(!0)}this.physics.add.collider(f,f),this.physics.add.collider(f,i),this.dialogDaemon=new s.DialogDaemon(this.charDaemon),n.AnswerStore.clearAll(),r.loadStoryLine("regular.json").then(t=>{this.storyLineDaemon=new s.StoryLineDaemon(t,this.dialogDaemon),this.storyLineDaemon.init()}),n.AnswerStore.listen("player_name",t=>{l.name=n.AnswerStore.get("player_name")});const p=this.anims;p.create({key:"misa-left-walk",frames:p.generateFrameNames("atlas",{prefix:"misa-left-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1}),p.create({key:"misa-right-walk",frames:p.generateFrameNames("atlas",{prefix:"misa-right-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1}),p.create({key:"misa-front-walk",frames:p.generateFrameNames("atlas",{prefix:"misa-front-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1}),p.create({key:"misa-back-walk",frames:p.generateFrameNames("atlas",{prefix:"misa-back-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1});this.add.text(640,512,"Mission",{font:"18px monospace",fill:"#000",backgroundColor:"#fff",padding:{x:10,y:10}}).setScrollFactor(0).setDepth(30).setInteractive().on("pointerdown",()=>{this.dialogDaemon.showHint()});const d=this.cameras.main;d.startFollow(h),d.setBounds(0,0,t.widthInPixels,t.heightInPixels),a=this.input.keyboard.createCursorKeys();this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER).on("down",(t,e)=>{if(this.dialogDaemon.hasOnGoingDialog)return;const i=this.dialogDaemon.findNearbyDialog(h);null!==i&&this.dialogDaemon.startDialog(i)}),this.add.text(16,16,'Arrow keys to move\nPress "D" to show hitboxes',{font:"18px monospace",fill:"#000000",padding:{x:20,y:10},backgroundColor:"#ffffff"}).setScrollFactor(0).setDepth(30),this.input.keyboard.once("keydown_D",t=>{this.physics.world.createDebugGraphic();const e=this.add.graphics().setAlpha(.75).setDepth(20);i.renderDebug(e,{tileColor:null,collidingTileColor:new Phaser.Display.Color(243,134,48,255),faceColor:new Phaser.Display.Color(40,39,37,255)})})},update:function(t,e){const i=this.dialogDaemon.checkDialogToTrigger(h);if(null!==i)return void this.dialogDaemon.startDialog(i);const n=h.body.velocity.clone();h.body.setVelocity(0),a.left.isDown?h.body.setVelocityX(-175):a.right.isDown&&h.body.setVelocityX(175);a.up.isDown?h.body.setVelocityY(-175):a.down.isDown&&h.body.setVelocityY(175);h.body.velocity.normalize().scale(175),a.left.isDown?h.anims.play("misa-left-walk",!0):a.right.isDown?h.anims.play("misa-right-walk",!0):a.up.isDown?h.anims.play("misa-back-walk",!0):a.down.isDown?h.anims.play("misa-front-walk",!0):(h.anims.stop(),n.x<0?h.setTexture("atlas","misa-left"):n.x>0?h.setTexture("atlas","misa-right"):n.y<0?h.setTexture("atlas","misa-back"):n.y>0&&h.setTexture("atlas","misa-front"));this.charDaemon.update()}}};new Phaser.Game(o);let a,h},function(t,e,i){!function(e,i){var n={version:"2.12.0",areas:{},apis:{},inherit:function(t,e){for(var i in t)e.hasOwnProperty(i)||Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i));return e},stringify:function(t){return void 0===t||"function"==typeof t?t+"":JSON.stringify(t)},parse:function(t,e){try{return JSON.parse(t,e||n.revive)}catch(e){return t}},fn:function(t,e){for(var i in n.storeAPI[t]=e,n.apis)n.apis[i][t]=e},get:function(t,e){return t.getItem(e)},set:function(t,e,i){t.setItem(e,i)},remove:function(t,e){t.removeItem(e)},key:function(t,e){return t.key(e)},length:function(t){return t.length},clear:function(t){t.clear()},Store:function(t,e,i){var s=n.inherit(n.storeAPI,(function(t,e,i){return 0===arguments.length?s.getAll():"function"==typeof e?s.transact(t,e,i):void 0!==e?s.set(t,e,i):"string"==typeof t||"number"==typeof t?s.get(t):"function"==typeof t?s.each(t):t?s.setAll(t,e):s.clear()}));s._id=t;try{e.setItem("__store2_test","ok"),s._area=e,e.removeItem("__store2_test")}catch(t){s._area=n.storage("fake")}return s._ns=i||"",n.areas[t]||(n.areas[t]=s._area),n.apis[s._ns+s._id]||(n.apis[s._ns+s._id]=s),s},storeAPI:{area:function(t,e){var i=this[t];return i&&i.area||(i=n.Store(t,e,this._ns),this[t]||(this[t]=i)),i},namespace:function(t,e){if(!t)return this._ns?this._ns.substring(0,this._ns.length-1):"";var i=t,s=this[i];if(!(s&&s.namespace||(s=n.Store(this._id,this._area,this._ns+i+"."),this[i]||(this[i]=s),e)))for(var r in n.areas)s.area(r,n.areas[r]);return s},isFake:function(){return"fake"===this._area.name},toString:function(){return"store"+(this._ns?"."+this.namespace():"")+"["+this._id+"]"},has:function(t){return this._area.has?this._area.has(this._in(t)):!!(this._in(t)in this._area)},size:function(){return this.keys().length},each:function(t,e){for(var i=0,s=n.length(this._area);i<s;i++){var r=this._out(n.key(this._area,i));if(void 0!==r&&!1===t.call(this,r,this.get(r),e))break;s>n.length(this._area)&&(s--,i--)}return e||this},keys:function(t){return this.each((function(t,e,i){i.push(t)}),t||[])},get:function(t,e){var i,s=n.get(this._area,this._in(t));return"function"==typeof e&&(i=e,e=null),null!==s?n.parse(s,i):null!=e?e:s},getAll:function(t){return this.each((function(t,e,i){i[t]=e}),t||{})},transact:function(t,e,i){var n=this.get(t,i),s=e(n);return this.set(t,void 0===s?n:s),this},set:function(t,e,i){var s=this.get(t);return null!=s&&!1===i?e:n.set(this._area,this._in(t),n.stringify(e),i)||s},setAll:function(t,e){var i,n;for(var s in t)n=t[s],this.set(s,n,e)!==n&&(i=!0);return i},add:function(t,e){var i=this.get(t);if(i instanceof Array)e=i.concat(e);else if(null!==i){var s=typeof i;if(s===typeof e&&"object"===s){for(var r in e)i[r]=e[r];e=i}else e=i+e}return n.set(this._area,this._in(t),n.stringify(e)),e},remove:function(t,e){var i=this.get(t,e);return n.remove(this._area,this._in(t)),i},clear:function(){return this._ns?this.each((function(t){n.remove(this._area,this._in(t))}),1):n.clear(this._area),this},clearAll:function(){var t=this._area;for(var e in n.areas)n.areas.hasOwnProperty(e)&&(this._area=n.areas[e],this.clear());return this._area=t,this},_in:function(t){return"string"!=typeof t&&(t=n.stringify(t)),this._ns?this._ns+t:t},_out:function(t){return this._ns?t&&0===t.indexOf(this._ns)?t.substring(this._ns.length):void 0:t}},storage:function(t){return n.inherit(n.storageAPI,{items:{},name:t})},storageAPI:{length:0,has:function(t){return this.items.hasOwnProperty(t)},key:function(t){var e=0;for(var i in this.items)if(this.has(i)&&t===e++)return i},setItem:function(t,e){this.has(t)||this.length++,this.items[t]=e},removeItem:function(t){this.has(t)&&(delete this.items[t],this.length--)},getItem:function(t){return this.has(t)?this.items[t]:null},clear:function(){for(var t in this.items)this.removeItem(t)}}},s=n.Store("local",function(){try{return localStorage}catch(t){}}());s.local=s,s._=n,s.area("session",function(){try{return sessionStorage}catch(t){}}()),s.area("page",n.storage("page")),"function"==typeof i&&void 0!==i.amd?i("store2",[],(function(){return s})):t.exports?t.exports=s:(e.store&&(n.conflict=e.store),e.store=s)}(this,this&&this.define)},function(t,e,i){"use strict";i.r(e),i.d(e,"Char",(function(){return o})),i.d(e,"CharDaemon",(function(){return a})),i.d(e,"StoryLineDaemon",(function(){return h})),i.d(e,"DialogDaemon",(function(){return c}));i(15);const n=i(34),s=i(11),r=i(7);class o{constructor(t,e,i,n,s,r,o){this.phaser=t,Number.isNaN(n)&&(n=0),Number.isNaN(s)&&(s=0),this.id=e,this.x=n,this.y=s,this._name=i,this.texture=r,this.frame=o,this.facing="DOWN",this.missionMark=null,this.makeContainer()}makeContainer(){this.player=this.phaser.physics.add.sprite(this.x,this.y,this.texture,this.frame).setSize(32,40).setOffset(0,24),this.text=this.phaser.add.text(this.x,this.y,this.name,{font:"18px monospace",fill:"#fff",align:"center"}).setOrigin(.5).setStroke("#000",3).setDepth(30)}get WIDTH(){return 32}get HEIGHT(){return 32}get SPEED(){return 256}get name(){return this._name}set name(t){this._name=t,this.text.setText(this.name)}showMissionMark(t){if(t){if(this.missionMark)return;this.missionMark=this.phaser.add.text(this.player.x,this.player.y-16,"!",{font:"24px monospace",fill:"#000",align:"center"}).setOrigin(.5).setStroke("#fff",3)}else this.missionMark.destroy(),this.missionMark=null}update(){this.text.setX(this.player.x),this.text.setY(this.player.y+45)}}class a{constructor(t){this.phaser=t,this.chars={}}create(t,e,i,n,s,r){if(t in this.chars)return console.error(`Character ID "${t}" is already declared:`),void console.error(this.chars[t]);const a=new o(this.phaser,t,e,i,n,s,r);return this.chars[t]=a,a}getChar(t){return this.chars.hasOwnProperty(t)?this.chars[t]:null}update(t,e){for(const i in this.chars)if(this.chars.hasOwnProperty(i)){this.chars[i].update(t,e)}}}class h{constructor(t,e){this.storyLine=t,this.dialogDaemon=e,this.missionWithDependencies={},r.AnswerStore.listen("*",t=>{console.log(this);for(const t in this.missionWithDependencies){const e=this.storyLine[t];e.isReady()&&(delete this.missionWithDependencies[t],this._addToDialogDaemon(e))}})}init(){for(const t in this.storyLine){if(!this.storyLine.hasOwnProperty(t))continue;const e=this.storyLine[t];e.isReady()?this._addToDialogDaemon(e):this.missionWithDependencies[t]=e}console.log("not enabled missions: ",this.missionWithDependencies)}_addToDialogDaemon(t){const e=t.firstStep,i=t.steps[e],n=`${t.id}/${i.id}`;this.dialogDaemon.add(n,i.npcId,i.dialog)}}class c{constructor(t){this.charDaemon=t,this.dialogs={},this.hasOnGoingDialog=!1,this.dialogToTrigger=[]}showHint(){let t="";for(const e in this.dialogs)if(this.dialogs.hasOwnProperty(e)){const i=this.dialogs[e];console.log(i),t+=`<h3>${i.dialog.missionStep.title}</h3>`,t+=`<p>${i.dialog.missionStep.description}</p>`}t||(t="沒有任務!"),bootbox.alert({title:"任務列表",message:t})}getDialog(t){return this.dialogs.hasOwnProperty(t)?this.dialogs[t]:null}showDialog(t){const e=t.getCurrentDialogItem();if(!e)return void this.doneDialog(t);this.hasOnGoingDialog=!0;const i=this.charDaemon.getChar("player"),n=e.name.replace(/\$player/,i.name);if(e instanceof s.DialogItemLine){const s=e.line.replace(/\$player/,i.name);bootbox.alert({title:n,message:s,callback:e=>{this.hasOnGoingDialog=!1;t.nextDialogItem()?this.showDialog(t):this.doneDialog(t)}})}else if(e instanceof s.DialogItemSelect){const s=e.question.replace(/\$player/,i.name),r=[];for(const t in e.choices){const n=e.choices[t].text;r.push({text:n.replace(/\$player/,i.name),value:t})}bootbox.prompt({title:n,message:s,inputType:"select",onEscape:!1,backdrop:!0,inputOptions:r,callback:e=>{if(null===e)return!1;this.hasOnGoingDialog=!1;return t.nextDialogItem(e)?this.showDialog(t):this.doneDialog(t),!0}})}else if(e instanceof s.DialogItemPrompt){const s=e.question.replace(/\$player/,i.name);bootbox.prompt({title:n,message:s,inputType:"text",onEscape:!1,backdrop:!0,callback:e=>{if(null===e)return!1;this.hasOnGoingDialog=!1;return t.nextDialogItem(e)?this.showDialog(t):this.doneDialog(t),!0}})}else if(e instanceof s.DialogItemMessage){const n=e.message.replace(/\$player/,i.name);bootbox.alert({title:"",message:n,callback:e=>{this.hasOnGoingDialog=!1;t.nextDialogItem()?this.showDialog(t):this.doneDialog(t)}})}}doneDialog(t){const e=t.dialog.missionStep,i=e.mission;this.remove(`${i.id}/${e.id}`),r.AnswerStore.setAndNotify(`${i.id}/${e.id}/done`,"true");const n=t.nextStep;if(!n)return;console.log(n);const s=i.steps[n];s&&this.add(`${i.id}/${s.id}`,s.npcId,s.dialog)}moveTo(t){const e=this.charDaemon.getChar("player");switch(console.log(e),t){case"SCHOOL":e.player.x=500,e.player.y=500}}startDialog(t){if(this.hasOnGoingDialog)return void console.warn("There is an on-going dialog, cannot start a new one");const e=this.getDialog(t);if(null===e)return void console.error("No such dialog: "+t);console.info("startDialog: "+t,e.dialog);const{npcId:i,dialog:n}=e;n.missionStep.moveTo&&this.moveTo(n.missionStep.moveTo);const s=n.getIterator();this.showDialog(s)}checkDialogToTrigger(t){if(this.hasOnGoingDialog)return null;for(const t in this.dialogToTrigger){if(!this.dialogToTrigger.hasOwnProperty(t))continue;const{dialogId:e}=this.dialogToTrigger[t];return this.dialogToTrigger.shift(),e}return null}findNearbyDialog(t){for(const e in this.dialogs){if(!this.dialogs.hasOwnProperty(e))continue;const{npcId:i,dialog:s}=this.dialogs[e],r=this.charDaemon.getChar(i);if(Math.hypot(r.x-t.x,r.y-t.y)<2*n.TILE_SIZE)return e}return null}add(t,e,i){if(null===this.getDialog(t)){if(void 0===e){i.missionStep;this.dialogToTrigger.push({dialogId:t,dialog:i})}else{const t=this.charDaemon.getChar(e);if(null===t)return void console.error(`NPC ${e} doesn't exist.`);t.showMissionMark(!0)}return this.dialogs[t]={npcId:e,dialog:i},this.dialogs[t]}console.error(`Dialog ${t} already exists.`)}remove(t){const e=this.getDialog(t);if(null===e)return;const{npcId:i,dialog:n}=e,s=this.charDaemon.getChar(i);null!==s&&s.showMissionMark(!1),delete this.dialogs[t]}}},function(t,e,i){t.exports=i(16),t.exports.internal={},i(24),t.exports.internal.Image=i(25),i(27),i(28),i(29),i(30),t.exports.Mouse=i(32),t.exports.Math=i(9),t.exports._extend=i(5),t.exports._create=i(1),i(33)},function(t,e,i){t.exports=i(0),t.exports.Matrix=i(10),t.exports.Texture=i(8),i(18),i(20),i(21),i(2),i(3),i(23)},function(t,e){t.exports=function(){var t=0;function e(e,i){return t+=i="number"==typeof i&&i>=1?i:1,function(){e&&e.apply(this,arguments),i>0&&(i--,t--,n())}}var i=[];function n(){if(0===t)for(;i.length;)setTimeout(i.shift(),0)}return e.then=function(e){0===t?setTimeout(e,0):i.push(e)},e}},function(t,e,i){"undefined"==typeof DEBUG&&(DEBUG=!0);var n=i(0),s=i(8),r=i(5),o=i(1),a=i(6),h=i(19),c={},u=[];function l(t){l._super.call(this);var e=this;_(t,"filter"),_(t,"cutouts"),_(t,"sprites"),_(t,"factory");var i=t.map||t.filter,n=t.ppu||t.ratio||1,s=t.trim||0,o=t.textures,c=t.factory,u=t.cutouts||t.sprites;function f(t){if(!t||a.fn(t.draw))return t;t=r({},t),a.fn(i)&&(t=i(t)),1!=n&&(t.x*=n,t.y*=n,t.width*=n,t.height*=n,t.top*=n,t.bottom*=n,t.left*=n,t.right*=n),0!=s&&(t.x+=s,t.y+=s,t.width-=2*s,t.height-=2*s,t.top-=s,t.bottom-=s,t.left-=s,t.right-=s);var o=e.pipe();return o.top=t.top,o.bottom=t.bottom,o.left=t.left,o.right=t.right,o.src(t.x,t.y,t.width,t.height),o}function p(t){if(o){if(a.fn(o))return o(t);if(a.hash(o))return o[t]}if(u){for(var e=null,i=0,n=0;n<u.length;n++)h.startsWith(u[n].name,t)&&(0===i?e=u[n]:1===i?e=[e,u[n]]:e.push(u[n]),i++);return 0===i&&a.fn(c)&&(e=function(e){return c(t+(e||""))}),e}}this.select=function(t){if(!t)return new d(this.pipe());var e=p(t);return e?new d(e,p,f):void 0}}n.atlas=function(t){var e=a.fn(t.draw)?t:new l(t);t.name&&(c[t.name]=e),u.push(e),_(t,"imagePath"),_(t,"imageRatio");var i=t.imagePath,s=t.imageRatio||1;return a.string(t.image)?i=t.image:a.hash(t.image)&&(i=t.image.src||t.image.url,s=t.image.ratio||s),i&&n.preload((function(t){i=n.resolve(i),DEBUG&&console.log("Loading atlas: "+i),n.config("image-loader")(i,(function(n){DEBUG&&console.log("Image loaded: "+i),e.src(n,s),t()}),(function(e){DEBUG&&console.log("Error loading atlas: "+i,e),t()}))})),e},l._super=s,l.prototype=o(l._super.prototype);var f=new s;f.x=f.y=f.width=f.height=0,f.pipe=f.src=f.dest=function(){return this},f.draw=function(){};var p=new d(f);function d(t,e,i){function n(t,s){return t?a.fn(t.draw)?t:a.hash(t)&&a.number(t.width)&&a.number(t.height)&&a.fn(i)?i(t):a.hash(t)&&a.defined(s)?n(t[s]):a.fn(t)?n(t(s)):a.array(t)?n(t[0]):a.string(t)&&a.fn(e)?n(e(t)):void 0:f}this.one=function(e){return n(t,e)},this.array=function(e){var i=a.array(e)?e:[];if(a.array(t))for(var s=0;s<t.length;s++)i[s]=n(t[s]);else i[0]=n(t);return i}}function _(t,e,i){e in t&&console.log(i?i.replace("%name",e):"'"+e+"' field of texture atlas is deprecated.")}n.texture=function(t){if(!a.string(t))return new d(t);var e,i,n=null;for((i=t.indexOf(":"))>0&&t.length>i+1&&(n=(e=c[t.slice(0,i)])&&e.select(t.slice(i+1))),!n&&(e=c[t])&&(n=e.select()),i=0;!n&&i<u.length;i++)n=u[i].select(t);return n||(console.error("Texture not found: "+t),n=p),n},t.exports=l},function(t,e){t.exports.startsWith=function(t,e){return"string"==typeof t&&"string"==typeof e&&t.substring(0,e.length)==e}},function(t,e,i){var n=i(0),s=i(6),r=0;function o(t,e){u(e),u(t),e.remove(),t._last&&(t._last._next=e,e._prev=t._last),e._parent=t,t._last=e,t._first||(t._first=e),e._parent._flag(e,!0),e._ts_parent=++r,t._ts_children=++r,t.touch()}function a(t,e){u(e),u(t),e.remove(),t._first&&(t._first._prev=e,e._next=t._first),e._parent=t,t._first=e,t._last||(t._last=e),e._parent._flag(e,!0),e._ts_parent=++r,t._ts_children=++r,t.touch()}function h(t,e){u(t),u(e),t.remove();var i=e._parent,n=e._prev;e._prev=t,n&&(n._next=t)||i&&(i._first=t),t._parent=i,t._prev=n,t._next=e,t._parent._flag(t,!0),t._ts_parent=++r,t.touch()}function c(t,e){u(t),u(e),t.remove();var i=e._parent,n=e._next;e._next=t,n&&(n._prev=t)||i&&(i._last=t),t._parent=i,t._prev=e,t._next=n,t._parent._flag(t,!0),t._ts_parent=++r,t.touch()}function u(t){if(t&&t instanceof n)return t;throw"Invalid node: "+t}n.prototype._label="",n.prototype._visible=!0,n.prototype._parent=null,n.prototype._next=null,n.prototype._prev=null,n.prototype._first=null,n.prototype._last=null,n.prototype._attrs=null,n.prototype._flags=null,n.prototype.toString=function(){return"["+this._label+"]"},n.prototype.id=function(t){return this.label(t)},n.prototype.label=function(t){return void 0===t?this._label:(this._label=t,this)},n.prototype.attr=function(t,e){return void 0===e?null!==this._attrs?this._attrs[t]:void 0:((null!==this._attrs?this._attrs:this._attrs={})[t]=e,this)},n.prototype.visible=function(t){return void 0===t?this._visible:(this._visible=t,this._parent&&(this._parent._ts_children=++r),this._ts_pin=++r,this.touch(),this)},n.prototype.hide=function(){return this.visible(!1)},n.prototype.show=function(){return this.visible(!0)},n.prototype.parent=function(){return this._parent},n.prototype.next=function(t){for(var e=this._next;e&&t&&!e._visible;)e=e._next;return e},n.prototype.prev=function(t){for(var e=this._prev;e&&t&&!e._visible;)e=e._prev;return e},n.prototype.first=function(t){for(var e=this._first;e&&t&&!e._visible;)e=e._next;return e},n.prototype.last=function(t){for(var e=this._last;e&&t&&!e._visible;)e=e._prev;return e},n.prototype.visit=function(t,e){var i=t.reverse,n=t.visible;if(!t.start||!t.start(this,e)){for(var s,r=i?this.last(n):this.first(n);s=r;)if(r=i?s.prev(n):s.next(n),s.visit(t,e))return!0;return t.end&&t.end(this,e)}},n.prototype.append=function(t,e){if(s.array(t))for(var i=0;i<t.length;i++)o(this,t[i]);else if(void 0!==e)for(i=0;i<arguments.length;i++)o(this,arguments[i]);else void 0!==t&&o(this,t);return this},n.prototype.prepend=function(t,e){if(s.array(t))for(var i=t.length-1;i>=0;i--)a(this,t[i]);else if(void 0!==e)for(i=arguments.length-1;i>=0;i--)a(this,arguments[i]);else void 0!==t&&a(this,t);return this},n.prototype.appendTo=function(t){return o(t,this),this},n.prototype.prependTo=function(t){return a(t,this),this},n.prototype.insertNext=function(t,e){if(s.array(t))for(var i=0;i<t.length;i++)c(t[i],this);else if(void 0!==e)for(i=0;i<arguments.length;i++)c(arguments[i],this);else void 0!==t&&c(t,this);return this},n.prototype.insertPrev=function(t,e){if(s.array(t))for(var i=t.length-1;i>=0;i--)h(t[i],this);else if(void 0!==e)for(i=arguments.length-1;i>=0;i--)h(arguments[i],this);else void 0!==t&&h(t,this);return this},n.prototype.insertAfter=function(t){return c(this,t),this},n.prototype.insertBefore=function(t){return h(this,t),this},n.prototype.remove=function(t,e){if(void 0!==t){if(s.array(t))for(var i=0;i<t.length;i++)u(t[i]).remove();else if(void 0!==e)for(i=0;i<arguments.length;i++)u(arguments[i]).remove();else u(t).remove();return this}return this._prev&&(this._prev._next=this._next),this._next&&(this._next._prev=this._prev),this._parent&&(this._parent._first===this&&(this._parent._first=this._next),this._parent._last===this&&(this._parent._last=this._prev),this._parent._flag(this,!1),this._parent._ts_children=++r,this._parent.touch()),this._prev=this._next=this._parent=null,this._ts_parent=++r,this},n.prototype.empty=function(){for(var t,e=this._first;t=e;)e=t._next,t._prev=t._next=t._parent=null,this._flag(t,!1);return this._first=this._last=null,this._ts_children=++r,this.touch(),this},n.prototype.touch=function(){return this._ts_touch=++r,this._parent&&this._parent.touch(),this},n.prototype._flag=function(t,e){if(void 0===e)return null!==this._flags&&this._flags[t]||0;if("string"==typeof t&&(e?(this._flags=this._flags||{},!this._flags[t]&&this._parent&&this._parent._flag(t,!0),this._flags[t]=(this._flags[t]||0)+1):this._flags&&this._flags[t]>0&&(1==this._flags[t]&&this._parent&&this._parent._flag(t,!1),this._flags[t]=this._flags[t]-1)),"object"==typeof t&&t._flags)for(var i in t._flags)t._flags[i]>0&&this._flag(i,e);return this},n.prototype.hitTest=function(t){return!!this.attr("spy")||t.x>=0&&t.x<=this._pin._width&&t.y>=0&&t.y<=this._pin._height},t.exports=n},function(t,e,i){i(22)(i(0).prototype,(function(t,e,i){t._flag(e,i)}))},function(t,e){t.exports=function(t,e){t._listeners=null,t.on=t.listen=function(t,i){if(!t||!t.length||"function"!=typeof i)return this;if(null===this._listeners&&(this._listeners={}),t=("string"!=typeof t&&"function"==typeof t.join?t.join(" "):t).match(/\S+/g))for(var n=0;n<t.length;n++){var s=t[n];this._listeners[s]=this._listeners[s]||[],this._listeners[s].push(i),"function"==typeof e&&e(this,s,!0)}return this},t.off=function(t,i){if(!t||!t.length||"function"!=typeof i)return this;if(null===this._listeners)return this;if(t=("string"!=typeof t&&"function"==typeof t.join?t.join(" "):t).match(/\S+/g))for(var n=0;n<t.length;n++){var s,r=t[n],o=this._listeners[r];o&&(s=o.indexOf(i))>=0&&(o.splice(s,1),o.length||delete this._listeners[r],"function"==typeof e&&e(this,r,!1))}return this},t.listeners=function(t){return this._listeners&&this._listeners[t]},t.publish=function(t,e){var i=this.listeners(t);if(!i||!i.length)return 0;for(var n=0;n<i.length;n++)i[n].apply(this,e);return i.length},t.trigger=function(t,e){return this.publish(t,e),this}}},function(t,e,i){var n=i(0);i(2),i(3);var s=i(4),r=i(1),o=i(5);function a(t,e){a._super.call(this),this.label("Root");var i=!0,n=this,r=0,o=function(a){if(!0!==i){s.tick=s.node=s.draw=0;var h=r||a,c=a-h;r=a;var u=n._tick(c,a,h);n._mo_touch!=n._ts_touch?(n._mo_touch=n._ts_touch,e(n),t(o)):u?t(o):i=!0,s.fps=c?1e3/c:0}};this.start=function(){return this.resume()},this.resume=function(){return i&&(this.publish("resume"),i=!1,t(o)),this},this.pause=function(){return i||this.publish("pause"),i=!0,this},this.touch_root=this.touch,this.touch=function(){return this.resume(),this.touch_root()}}a._super=n,a.prototype=r(a._super.prototype),n.root=function(t,e){return new a(t,e)},a.prototype.background=function(t){return this},a.prototype.viewport=function(t,e,i){if(void 0===t)return o({},this._viewport);this._viewport={width:t,height:e,ratio:i||1},this.viewbox();var n=o({},this._viewport);return this.visit({start:function(t){if(!t._flag("viewport"))return!0;t.publish("viewport",[n])}}),this},a.prototype.viewbox=function(t,e,i){"number"==typeof t&&"number"==typeof e&&(this._viewbox={width:t,height:e,mode:/^(in|out|in-pad|out-crop)$/.test(i)?i:"in-pad"});var n=this._viewbox,s=this._viewport;return s&&n?(this.pin({width:n.width,height:n.height}),this.scaleTo(s.width,s.height,n.mode)):s&&this.pin({width:s.width,height:s.height}),this}},function(t,e,i){var n=i(0),s=i(8);n.canvas=function(t,e,i){"string"==typeof t?"object"==typeof e||("function"==typeof e&&(i=e),e={}):("function"==typeof t&&(i=t),e={},t="2d");var n=document.createElement("canvas"),r=n.getContext(t,e),o=new s(n);return o.context=function(){return r},o.size=function(t,e,i){return i=i||1,n.width=t*i,n.height=e*i,this.src(n,i),this},o.canvas=function(t){return"function"==typeof t?t.call(this,r):void 0===t&&"function"==typeof i&&i.call(this,r),this},"function"==typeof i&&i.call(o,r),o}},function(t,e,i){var n=i(0);i(2),i(3);var s=i(26),r=i(1);function o(){o._super.call(this),this.label("Image"),this._textures=[],this._image=null}t.exports=o,n.image=function(t){var e=new o;return t&&e.image(t),e},o._super=n,o.prototype=r(o._super.prototype),o.prototype.setImage=function(t,e,i){return this.image(t,e,i)},o.prototype.image=function(t){return this._image=n.texture(t).one(),this.pin("width",this._image?this._image.width:0),this.pin("height",this._image?this._image.height:0),this._textures[0]=this._image.pipe(),this._textures.length=1,this},o.prototype.tile=function(t){return this._repeat(!1,t),this},o.prototype.stretch=function(t){return this._repeat(!0,t),this},o.prototype._repeat=function(t,e){var i=this;function n(t,e,n,s,r,o,a,h,c){var u=i._textures.length>t?i._textures[t]:i._textures[t]=i._image.pipe();u.src(e,n,s,r),u.dest(o,a,h,c)}this.untick(this._repeatTicker),this.tick(this._repeatTicker=function(){if(this._mo_stretch!=this._pin._ts_transform){this._mo_stretch=this._pin._ts_transform;var i=this.pin("width"),r=this.pin("height");this._textures.length=s(this._image,i,r,t,e,n)}})}},function(t,e){t.exports=function(t,e,i,n,s,r){var o=t.width,a=t.height,h=t.left,c=t.right,u=t.top,l=t.bottom;o=o-(h="number"==typeof h&&h==h?h:0)-(c="number"==typeof c&&c==c?c:0),a=a-(u="number"==typeof u&&u==u?u:0)-(l="number"==typeof l&&l==l?l:0),s||(e=Math.max(e-h-c,0),i=Math.max(i-u-l,0));var f=0;if(u>0&&h>0&&r(f++,0,0,h,u,0,0,h,u),l>0&&h>0&&r(f++,0,a+u,h,l,0,i+u,h,l),u>0&&c>0&&r(f++,o+h,0,c,u,e+h,0,c,u),l>0&&c>0&&r(f++,o+h,a+u,c,l,e+h,i+u,c,l),n)u>0&&r(f++,h,0,o,u,h,0,e,u),l>0&&r(f++,h,a+u,o,l,h,i+u,e,l),h>0&&r(f++,0,u,h,a,0,u,h,i),c>0&&r(f++,o+h,u,c,a,e+h,u,c,i),r(f++,h,u,o,a,h,u,e,i);else for(var p,d=h,_=e;_>0;){p=Math.min(o,_),_-=o;for(var g,m=u,y=i;y>0;)g=Math.min(a,y),y-=a,r(f++,h,u,p,g,d,m,p,g),_<=0&&(h&&r(f++,0,u,h,g,0,m,h,g),c&&r(f++,o+h,u,c,g,d+p,m,c,g)),m+=g;u&&r(f++,h,0,p,u,d,0,p,u),l&&r(f++,h,a+u,p,l,d,m,p,l),d+=p}return f}},function(t,e,i){var n=i(0);i(2),i(3);var s=i(1),r=i(9);function o(){o._super.call(this),this.label("Anim"),this._textures=[],this._fps=n.Anim.FPS,this._ft=1e3/this._fps,this._time=-1,this._repeat=0,this._index=0,this._frames=[];var t=0;this.tick((function(e,i,n){if(!(this._time<0||this._frames.length<=1)){var s=t!=n;if(t=i,s)return!0;if(this._time+=e,this._time<this._ft)return!0;var r=this._time/this._ft|0;return this._time-=r*this._ft,this.moveFrame(r),!(this._repeat>0&&(this._repeat-=r)<=0)||(this.stop(),this._callback&&this._callback(),!1)}}),!1)}n.anim=function(t,e){var i=new o;return i.frames(t).gotoFrame(0),e&&i.fps(e),i},o._super=n,o.prototype=s(o._super.prototype),n.Anim={FPS:15},o.prototype.fps=function(t){return void 0===t?this._fps:(this._fps=t>0?t:n.Anim.FPS,this._ft=1e3/this._fps,this)},o.prototype.setFrames=function(t,e,i){return this.frames(t,e,i)},o.prototype.frames=function(t){return this._index=0,this._frames=n.texture(t).array(),this.touch(),this},o.prototype.length=function(){return this._frames?this._frames.length:0},o.prototype.gotoFrame=function(t,e){return this._index=0|r.rotate(t,this._frames.length),e=e||!this._textures[0],this._textures[0]=this._frames[this._index],e&&(this.pin("width",this._textures[0].width),this.pin("height",this._textures[0].height)),this.touch(),this},o.prototype.moveFrame=function(t){return this.gotoFrame(this._index+t)},o.prototype.repeat=function(t,e){return this._repeat=t*this._frames.length-1,this._callback=e,this.play(),this},o.prototype.play=function(t){return void 0!==t?(this.gotoFrame(t),this._time=0):this._time<0&&(this._time=0),this.touch(),this},o.prototype.stop=function(t){return this._time=-1,void 0!==t&&this.gotoFrame(t),this}},function(t,e,i){var n=i(0);i(2),i(3);var s=i(1),r=i(6);function o(){o._super.call(this),this.label("String"),this._textures=[]}n.string=function(t){return(new o).frames(t)},o._super=n,o.prototype=s(o._super.prototype),o.prototype.setFont=function(t,e,i){return this.frames(t,e,i)},o.prototype.frames=function(t){return this._textures=[],"string"==typeof t?(t=n.texture(t),this._item=function(e){return t.one(e)}):"object"==typeof t?this._item=function(e){return t[e]}:"function"==typeof t&&(this._item=t),this},o.prototype.setValue=function(t,e,i){return this.value(t,e,i)},o.prototype.value=function(t){if(void 0===t)return this._value;if(this._value===t)return this;this._value=t,null===t?t="":"string"==typeof t||r.array(t)||(t=t.toString()),this._spacing=this._spacing||0;for(var e=0,i=0,n=0;n<t.length;n++){var s=this._textures[n]=this._item(t[n]);e+=n>0?this._spacing:0,s.dest(e,0),e+=s.width,i=Math.max(i,s.height)}return this.pin("width",e),this.pin("height",i),this._textures.length=t.length,this}},function(t,e,i){var n=i(0);i(2),i(3);i(1);n.row=function(t){return n.create().row(t).label("Row")},n.prototype.row=function(t){return this.sequence("row",t),this},n.column=function(t){return n.create().column(t).label("Row")},n.prototype.column=function(t){return this.sequence("column",t),this},n.sequence=function(t,e){return n.create().sequence(t,e).label("Sequence")},n.prototype.sequence=function(t,e){return this._padding=this._padding||0,this._spacing=this._spacing||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_seq!=this._ts_touch){this._mo_seq=this._ts_touch;var i=this._mo_seqAlign!=this._ts_children;this._mo_seqAlign=this._ts_children;for(var n,s=0,r=0,o=this.first(!0),a=!0;n=o;){o=n.next(!0),n.matrix(!0);var h=n.pin("boxWidth"),c=n.pin("boxHeight");"column"==t?(!a&&(r+=this._spacing),n.pin("offsetY")!=r&&n.pin("offsetY",r),s=Math.max(s,h),r+=c,i&&n.pin("alignX",e)):"row"==t&&(!a&&(s+=this._spacing),n.pin("offsetX")!=s&&n.pin("offsetX",s),s+=h,r=Math.max(r,c),i&&n.pin("alignY",e)),a=!1}s+=2*this._padding,r+=2*this._padding,this.pin("width")!=s&&this.pin("width",s),this.pin("height")!=r&&this.pin("height",r)}}),this},n.box=function(){return n.create().box().label("Box")},n.prototype.box=function(){return this._padding=this._padding||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_box!=this._ts_touch){this._mo_box=this._ts_touch;for(var t,e=0,i=0,n=this.first(!0);t=n;){n=t.next(!0),t.matrix(!0);var s=t.pin("boxWidth"),r=t.pin("boxHeight");e=Math.max(e,s),i=Math.max(i,r)}e+=2*this._padding,i+=2*this._padding,this.pin("width")!=e&&this.pin("width",e),this.pin("height")!=i&&this.pin("height",i)}}),this},n.layer=function(){return n.create().layer().label("Layer")},n.prototype.layer=function(){return this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){var t=this.parent();if(t){var e=t.pin("width");this.pin("width")!=e&&this.pin("width",e);var i=t.pin("height");this.pin("height")!=i&&this.pin("height",i)}},!0),this},n.prototype.padding=function(t){return this._padding=t,this},n.prototype.spacing=function(t){return this._spacing=t,this}},function(t,e,i){var n=i(31),s=i(0),r=i(2);function o(t,e,i){this._end={},this._duration=e||400,this._delay=i||0,this._owner=t,this._time=0}function a(t,e,i,n){"number"==typeof t.pin(i)?e[i]=n:"number"==typeof t.pin(i+"X")&&"number"==typeof t.pin(i+"Y")&&(e[i+"X"]=n,e[i+"Y"]=n)}s.prototype.tween=function(t,e,i){if("number"!=typeof t?(i=t,e=0,t=0):"number"!=typeof e&&(i=e,e=0),!this._tweens){this._tweens=[];var n=0;this.tick((function(t,e,i){if(this._tweens.length){var s=n!=i;if(n=e,s)return!0;var r=this._tweens[0],o=r.tick(this,t,e,i);if(o&&r===this._tweens[0]&&this._tweens.shift(),"function"==typeof o)try{o.call(this)}catch(t){console.log(t)}return"object"==typeof o&&this._tweens.unshift(o),!0}}),!0)}this.touch(),i||(this._tweens.length=0);var s=new o(this,t,e);return this._tweens.push(s),s},o.prototype.tick=function(t,e,i,n){if(this._time+=e,!(this._time<this._delay)){var s,r,o=this._time-this._delay;if(!this._start)for(var a in this._start={},this._end)this._start[a]=this._owner.pin(a);o<this._duration?(s=o/this._duration,r=!1):(s=1,r=!0),"function"==typeof this._easing&&(s=this._easing(s));var h=1-s;for(var a in this._end)this._owner.pin(a,this._start[a]*h+this._end[a]*s);return r?this._next||this._done||!0:void 0}},o.prototype.tween=function(t,e){return this._next=new o(this._owner,t,e)},o.prototype.duration=function(t){return this._duration=t,this},o.prototype.delay=function(t){return this._delay=t,this},o.prototype.ease=function(t){return this._easing=n(t),this},o.prototype.done=function(t){return this._done=t,this},o.prototype.hide=function(){return this.done((function(){this.hide()})),this},o.prototype.remove=function(){return this.done((function(){this.remove()})),this},o.prototype.pin=function(t,e){if("object"==typeof t)for(var i in t)a(this._owner,this._end,i,t[i]);else void 0!==e&&a(this._owner,this._end,t,e);return this},r._add_shortcuts(o),o.prototype.then=function(t){return this.done(t),this},o.prototype.clear=function(t){return this},t.exports=o},function(t,e){function i(t){return t}var n={},s={},r={};function o(t){if("function"==typeof t)return t;if("string"!=typeof t)return i;var e=n[t];if(e)return e;var o=/^(\w+)(-(in|out|in-out|out-in))?(\((.*)\))?$/i.exec(t);if(!o||!o.length)return i;var a=r[o[1]],h=s[o[3]],c=o[5];return e=a&&a.fn?a.fn:a&&a.fc?a.fc.apply(a.fc,c&&c.replace(/\s+/,"").split(",")):i,h&&(e=h.fn(e)),n[t]=e,e}o.add=function(t){for(var e=(t.name||t.mode).split(/\s+/),i=0;i<e.length;i++){var n=e[i];n&&((t.name?r:s)[n]=t)}},o.add({mode:"in",fn:function(t){return t}}),o.add({mode:"out",fn:function(t){return function(e){return 1-t(1-e)}}}),o.add({mode:"in-out",fn:function(t){return function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2}}}),o.add({mode:"out-in",fn:function(t){return function(e){return e<.5?1-t(2*(1-e))/2:t(2*e)/2}}}),o.add({name:"linear",fn:function(t){return t}}),o.add({name:"quad",fn:function(t){return t*t}}),o.add({name:"cubic",fn:function(t){return t*t*t}}),o.add({name:"quart",fn:function(t){return t*t*t*t}}),o.add({name:"quint",fn:function(t){return t*t*t*t*t}}),o.add({name:"sin sine",fn:function(t){return 1-Math.cos(t*Math.PI/2)}}),o.add({name:"exp expo",fn:function(t){return 0==t?0:Math.pow(2,10*(t-1))}}),o.add({name:"circle circ",fn:function(t){return 1-Math.sqrt(1-t*t)}}),o.add({name:"bounce",fn:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}}),o.add({name:"poly",fc:function(t){return function(e){return Math.pow(e,t)}}}),o.add({name:"elastic",fc:function(t,e){t=t||1;var i=(e=e||.45)/(2*Math.PI)*Math.asin(1/t);return function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-i)*(2*Math.PI)/e)}}}),o.add({name:"back",fc:function(t){return t=void 0!==t?t:1.70158,function(e){return e*e*((t+1)*e-t)}}}),t.exports=o},function(t,e,i){function n(t,e){if(this instanceof n){var i=t.viewport().ratio||1;t.on("viewport",(function(t){i=t.ratio||i})),this.x=0,this.y=0,this.toString=function(){return(0|this.x)+"x"+(0|this.y)},this.locate=function(t){!function(t,e,i){e.touches&&e.touches.length?(i.x=e.touches[0].clientX,i.y=e.touches[0].clientY):(i.x=e.clientX,i.y=e.clientY);var n=t.getBoundingClientRect();i.x-=n.left,i.y-=n.top,i.x-=0|t.clientLeft,i.y-=0|t.clientTop}(e,t,this),this.x*=i,this.y*=i},this.lookup=function(e,i){this.type=e,this.root=t,this.event=null,i.length=0,this.collect=i,this.root.visit(this.visitor,this)},this.publish=function(e,i,n){if(this.type=e,this.root=t,this.event=i,this.collect=!1,this.timeStamp=Date.now(),"mousemove"!==e&&"touchmove"!==e&&DEBUG&&console.log(this.type+" "+this),n){for(;n.length&&!this.visitor.end(n.shift(),this););n.length=0}else this.root.visit(this.visitor,this)},this.visitor={reverse:!0,visible:!0,start:function(t,e){return!t._flag(e.type)},end:function(t,e){s.raw=e.event,s.type=e.type,s.timeStamp=e.timeStamp,s.abs.x=e.x,s.abs.y=e.y;var i=t.listeners(e.type);if(i&&(t.matrix().inverse().map(e,s),(t===e.root||t.hitTest(s))&&(e.collect&&e.collect.push(t),e.event))){for(var n=!1,r=0;r<i.length;r++)n=!!i[r].call(t,s)||n;return n}}}}}"undefined"==typeof DEBUG&&(DEBUG=!0),i(0)._load((function(t,e){n.subscribe(t,e)})),n.CLICK="click",n.START="touchstart mousedown",n.MOVE="touchmove mousemove",n.END="touchend mouseup",n.CANCEL="touchcancel mousecancel",n.subscribe=function(t,e){if(!t.mouse){t.mouse=new n(t,e),e.addEventListener("touchstart",r),e.addEventListener("touchend",a),e.addEventListener("touchmove",o),e.addEventListener("touchcancel",h),e.addEventListener("mousedown",r),e.addEventListener("mouseup",a),e.addEventListener("mousemove",o),document.addEventListener("mouseup",h),window.addEventListener("blur",h);var i=[],s=[]}function r(e){e.preventDefault(),t.mouse.locate(e),t.mouse.publish(e.type,e),t.mouse.lookup("click",i),t.mouse.lookup("mousecancel",s)}function o(e){e.preventDefault(),t.mouse.locate(e),t.mouse.publish(e.type,e)}function a(e){e.preventDefault(),t.mouse.publish(e.type,e),i.length&&t.mouse.publish("click",e,i),s.length=0}function h(e){s.length&&t.mouse.publish("mousecancel",e,s),i.length=0}};var s={},r={};function o(t,e,i){Object.defineProperty(t,e,{value:i})}o(s,"clone",(function(t){return(t=t||{}).x=this.x,t.y=this.y,t})),o(s,"toString",(function(){return(0|this.x)+"x"+(0|this.y)+" ("+this.abs+")"})),o(s,"abs",r),o(r,"clone",(function(t){return(t=t||{}).x=this.x,t.y=this.y,t})),o(r,"toString",(function(){return(0|this.x)+"x"+(0|this.y)})),t.exports=n},function(t,e,i){"undefined"==typeof DEBUG&&(DEBUG=!0);var n,s=i(0);s._supported=!(!(n=document.createElement("canvas")).getContext||!n.getContext("2d")),window.addEventListener("load",(function(){DEBUG&&console.log("On load."),s._supported&&s.start()}),!1),s.config({"app-loader":function(t,e){var i,n=(e=e||{}).canvas,r=null,o=!1,a=0,h=0;"string"==typeof n&&(n=document.getElementById(n));n||(n=document.getElementById("cutjs")||document.getElementById("stage"));if(!n){o=!0,DEBUG&&console.log("Creating Canvas..."),(n=document.createElement("canvas")).style.position="absolute",n.style.top="0",n.style.left="0";var c=document.body;c.insertBefore(n,c.firstChild)}r=n.getContext("2d");var u=window.devicePixelRatio||1,l=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;i=u/l;var f=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)};DEBUG&&console.log("Creating stage...");var p=s.root(f,d);function d(){r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,a,h),p.render(r)}function _(){o?(a=window.innerWidth>0?window.innerWidth:screen.width,h=window.innerHeight>0?window.innerHeight:screen.height,n.style.width=a+"px",n.style.height=h+"px"):(a=n.clientWidth,h=n.clientHeight),a*=i,h*=i,n.width===a&&n.height===h||(n.width=a,n.height=h,DEBUG&&console.log("Resize: "+a+" x "+h+" / "+i),p.viewport(a,h,i),d())}p.background=function(t){return n.style.backgroundColor=t,this},t(p,n),_(),window.addEventListener("resize",_,!1),window.addEventListener("orientationchange",_,!1)},"image-loader":function(t,e,i){DEBUG&&console.log("Loading image: "+t);var n=new Image;n.onload=function(){e(n)},n.onerror=i,n.src=t}})},function(t,e,i){"use strict";i.r(e),i.d(e,"API_URL",(function(){return n})),i.d(e,"TILE_SIZE",(function(){return s}));const n="https://meet.jothon.online/api/",s=32}]);