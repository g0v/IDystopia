!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=3)}([function(t,e,s){"use strict";s.d(e,"a",(function(){return h})),s.d(e,"b",(function(){return d}));var i=s(1),n=s.n(i);const o={"0000000001":"MISSION/intro/step-1/done","0000000002":"MISSION/receive-package/step-1/done","0000000003":"RESPONSE/player_occupation/學生","0000000004":"RESPONSE/player_occupation/工程師","0000000005":"RESPONSE/player_occupation/律師","0000000006":"RESPONSE/player_occupation/健身教練","0000000007":"RESPONSE/player_occupation/中年職業婦女","0000000008":"RESPONSE/player_occupation/記者","0000000009":"MISSION/receive-package/step-2/done","0000000010":"MISSION/student-scene-intro/step-1/done","0000000011":"MISSION/student-scene-intro/step-2/done","0000000012":"MISSION/student-scene-intro/step-3/done","0000000013":"RESPONSE/student-intro-choice/passive","0000000014":"RESPONSE/student-intro-choice/proactive","0000000015":"MISSION/student-scene-academic-affairs-office/step-1/done","0000000016":"RESPONSE/student_asked_followup_question/false","0000000017":"RESPONSE/student_asked_followup_question/true","0000000018":"MISSION/student-scene-department-office/step-1/done","0000000019":"MISSION/student-scene-home-2/step-1/done","0000000020":"MISSION/student-scene-home-2/step-2/done","0000000021":"MISSION/student-scene-home-2/step-3/done","0000000022":"RESPONSE/student-gene-interested-in/gene","0000000023":"RESPONSE/student-gene-interested-in/system"},a={};for(const t in o)a[o[t]]=t;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}!function(t){const e=[];t.fn("setAndNotify",(function(t,e){if(this.set(t,e),this.callbacks){if(r(this.callbacks,t))for(const e of this.callbacks[t])e.call(this,t);if(r(this.callbacks,"*"))for(const e of this.callbacks["*"])e.call(this,t)}})),t.fn("notify",(function(){for(const t in e)if(r(this.callbacks,t))for(const e of this.callbacks[t])e.call(this)})),t.fn("listen",(function(t,e){void 0===this.callbacks&&(this.callbacks={}),void 0===this.callbacks[t]&&(this.callbacks[t]=[]),this.callbacks[t].push(e)}))}(n.a._);const c="https://pingtung-hao-305236.middle2.me",l=n.a.namespace("REMOTE_STORE_CACHE");const h=n.a.namespace("DIALOG_ANSWER"),d=new class{constructor(){this._tokenChecked=!1}get token(){return l.get("token")}async _register(){const t=await fetch(c+"/register",{method:"POST"}),e=await t.json();if(e.token){l.set("token",e.token);const t=(new Date).getTime()+864e5;l.set("expire",t),this._tokenChecked=!0}}async _ensureToken(){if(!l.has("token"))return await this._register();if((new Date).getTime()>l.get("expire",0))return await this._register();if(!this._tokenChecked){const t=this.token,e=await fetch(`${c}/check_token?token=${t}`,{method:"GET"});if(!0!==(await e.json()).ok)return await this._register();this._tokenChecked=!0}}async _inc(t){await this._ensureToken(),console.log("increasing key: "+t);const e=`${c}/inc?token=${this.token}&key=${t}`,s=await fetch(e,{method:"POST"}),i=await s.json();return console.log(`increased key: ${t} -> ${i.value}, data: `,i),i.value}async _getc(t){await this._ensureToken();const e=`${c}/getc?token=${this.token}&key=${t}`,s=await fetch(e,{method:"GET"});return(await s.json()).value}increase(t){return t=a[t],this._inc(t)}getCount(t){return t=a[t],this._getc(t)}async getAllCount(){const t={};for(const e in o){const s=o[e],i=await this.getCount(s);t[s]=i}return t}}},function(t,e,s){var i,n,o,a;i=this,n=this&&this.define,o={version:"2.12.0",areas:{},apis:{},inherit:function(t,e){for(var s in t)e.hasOwnProperty(s)||Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s));return e},stringify:function(t){return void 0===t||"function"==typeof t?t+"":JSON.stringify(t)},parse:function(t,e){try{return JSON.parse(t,e||o.revive)}catch(e){return t}},fn:function(t,e){for(var s in o.storeAPI[t]=e,o.apis)o.apis[s][t]=e},get:function(t,e){return t.getItem(e)},set:function(t,e,s){t.setItem(e,s)},remove:function(t,e){t.removeItem(e)},key:function(t,e){return t.key(e)},length:function(t){return t.length},clear:function(t){t.clear()},Store:function(t,e,s){var i=o.inherit(o.storeAPI,(function(t,e,s){return 0===arguments.length?i.getAll():"function"==typeof e?i.transact(t,e,s):void 0!==e?i.set(t,e,s):"string"==typeof t||"number"==typeof t?i.get(t):"function"==typeof t?i.each(t):t?i.setAll(t,e):i.clear()}));i._id=t;try{e.setItem("__store2_test","ok"),i._area=e,e.removeItem("__store2_test")}catch(t){i._area=o.storage("fake")}return i._ns=s||"",o.areas[t]||(o.areas[t]=i._area),o.apis[i._ns+i._id]||(o.apis[i._ns+i._id]=i),i},storeAPI:{area:function(t,e){var s=this[t];return s&&s.area||(s=o.Store(t,e,this._ns),this[t]||(this[t]=s)),s},namespace:function(t,e){if(!t)return this._ns?this._ns.substring(0,this._ns.length-1):"";var s=t,i=this[s];if(!(i&&i.namespace||(i=o.Store(this._id,this._area,this._ns+s+"."),this[s]||(this[s]=i),e)))for(var n in o.areas)i.area(n,o.areas[n]);return i},isFake:function(){return"fake"===this._area.name},toString:function(){return"store"+(this._ns?"."+this.namespace():"")+"["+this._id+"]"},has:function(t){return this._area.has?this._area.has(this._in(t)):!!(this._in(t)in this._area)},size:function(){return this.keys().length},each:function(t,e){for(var s=0,i=o.length(this._area);s<i;s++){var n=this._out(o.key(this._area,s));if(void 0!==n&&!1===t.call(this,n,this.get(n),e))break;i>o.length(this._area)&&(i--,s--)}return e||this},keys:function(t){return this.each((function(t,e,s){s.push(t)}),t||[])},get:function(t,e){var s,i=o.get(this._area,this._in(t));return"function"==typeof e&&(s=e,e=null),null!==i?o.parse(i,s):null!=e?e:i},getAll:function(t){return this.each((function(t,e,s){s[t]=e}),t||{})},transact:function(t,e,s){var i=this.get(t,s),n=e(i);return this.set(t,void 0===n?i:n),this},set:function(t,e,s){var i=this.get(t);return null!=i&&!1===s?e:o.set(this._area,this._in(t),o.stringify(e),s)||i},setAll:function(t,e){var s,i;for(var n in t)i=t[n],this.set(n,i,e)!==i&&(s=!0);return s},add:function(t,e){var s=this.get(t);if(s instanceof Array)e=s.concat(e);else if(null!==s){var i=typeof s;if(i===typeof e&&"object"===i){for(var n in e)s[n]=e[n];e=s}else e=s+e}return o.set(this._area,this._in(t),o.stringify(e)),e},remove:function(t,e){var s=this.get(t,e);return o.remove(this._area,this._in(t)),s},clear:function(){return this._ns?this.each((function(t){o.remove(this._area,this._in(t))}),1):o.clear(this._area),this},clearAll:function(){var t=this._area;for(var e in o.areas)o.areas.hasOwnProperty(e)&&(this._area=o.areas[e],this.clear());return this._area=t,this},_in:function(t){return"string"!=typeof t&&(t=o.stringify(t)),this._ns?this._ns+t:t},_out:function(t){return this._ns?t&&0===t.indexOf(this._ns)?t.substring(this._ns.length):void 0:t}},storage:function(t){return o.inherit(o.storageAPI,{items:{},name:t})},storageAPI:{length:0,has:function(t){return this.items.hasOwnProperty(t)},key:function(t){var e=0;for(var s in this.items)if(this.has(s)&&t===e++)return s},setItem:function(t,e){this.has(t)||this.length++,this.items[t]=e},removeItem:function(t){this.has(t)&&(delete this.items[t],this.length--)},getItem:function(t){return this.has(t)?this.items[t]:null},clear:function(){for(var t in this.items)this.removeItem(t)}}},(a=o.Store("local",function(){try{return localStorage}catch(t){}}())).local=a,a._=o,a.area("session",function(){try{return sessionStorage}catch(t){}}()),a.area("page",o.storage("page")),"function"==typeof n&&void 0!==n.amd?n("store2",[],(function(){return a})):t.exports?t.exports=a:(i.store&&(o.conflict=i.store),i.store=a)},,function(t,e,s){"use strict";s.r(e);var i=s(0);class n{constructor(t,e,s,i,n){this.id=t,this.title=e,this.description=s,this.depend=i,this.firstStep=n,this.steps={}}addStep(t){this.steps[t.id]=t}isReady(){if(console.log("checking dependency of "+this.id),!this.depend)return!0;for(const t in this.depend){const e=this.depend[t];let s,n;if(console.log("condition: ",e),"string"==typeof e?s=e:"object"==typeof e&&(s=e.storeKey,n=e.value),!i.a.has(s))return!1;if(!n)continue;if(i.a.get(s)!==n)return!1}return console.log(this.id+" is ready!"),!0}static fromDict(t,e){const s=e.title||"Unnamed Mission",i=e.description||"no description",a=e.firstStep||"step-1",r=(e.depend||[]).filter(t=>"string"==typeof t||t instanceof String||("object"==typeof t||(console.warn(t+" is not a string nor an object"),!1))),c=new n(t,s,i,r,a);for(const t in e.steps){const s=o.fromDict(t,e.steps[t],c);c.addStep(s)}return c}}class o{constructor({id:t,title:e,description:s,nextStep:i,npcId:n,dialog:o,mission:a,moveTo:r}){this.id=t,this.title=e||"Unnamed Step",this.description=s||"...",this.nextStep=i,this.npcId=n,this.dialog=o,this.mission=a,this.moveTo=r}static fromDict(t,e,s){const i={id:t,mission:s,...e},n=new o(i),r=a.fromDict(e.dialog||[],n);return n.dialog=r,n}}class a{constructor(t){this.missionStep=t,this.dialogItems=[],this.dialogIdMap={}}addDialogItem(t){this.dialogItems.push(t),void 0!==t.id&&(this.dialogIdMap[t.id]=this.dialogItems.length-1)}getIterator(){return new r(this,this.missionStep.nextStep)}static fromDict(t,e){const s=new a(e);for(const e of t){const t=c.fromDict(e);s.addDialogItem(t)}return s}}class r{constructor(t,e){this.dialog=t,this.currentIndex=0,this.nextStep=e}getCurrentDialogItem(){const t=this.dialog.dialogItems[this.currentIndex];return t&&t.nextStep&&(this.nextStep=t.nextStep),t}nextDialogItem(t){const e=this.dialog.dialogItems[this.currentIndex];let s=this.currentIndex+1;if(void 0!==e.nextLine&&(s=this.dialog.dialogIdMap[e.nextLine]),e instanceof h&&(void 0===t&&(console.warn("This is a multiple choice question, but no selected answer. Default to the first answer."),t=0),void 0!==e.choices[t].nextLine)){const i=e.choices[t].nextLine;s=this.dialog.dialogIdMap[i]}if(e instanceof d&&e.storeKey&&i.a.setAndNotify(e.storeKey,t),e instanceof h){const s=e.choices[t].value||t;e.storeKey&&(i.a.setAndNotify(e.storeKey,s),i.b.increase("USER_RESPONSE/"+e.storeKey))}return console.info(`${this.dialog.missionStep.id} The next line is: ${s}`),this.currentIndex=s,this.getCurrentDialogItem()}}class c{constructor(t,{id:e,nextLine:s}){this.name=t,this.id=e,this.nextLine=s}static fromDict(t){const e=t.name||"John Doe",s=t.type||"line";switch(s){case"line":return new l(e,t);case"input.select":return new h(e,t);case"input.text":return new d(e,t);case"message":return new u(e,t);default:return console.warn("unkonwn dialog type: %s",s),new l(e,t)}}}class l extends c{constructor(t,{id:e,nextLine:s,line:i}){super(t,{id:e,nextLine:s}),void 0===i&&(console.warn("One of `line` and `question` should be defined."),i="..."),this.line=i}}class h extends c{constructor(t,{id:e,nextLine:s,question:i,choices:n,storeKey:o}){super(t,{id:e,nextLine:s}),void 0===i&&(console.warn("set default question"),i="Please select an answer."),this.question=i,void 0!==n&&n||(console.warn("set default choices"),n=[{text:"Ok"}]),this.choices=n,this.storeKey=o}}class d extends c{constructor(t,{id:e,nextLine:s,question:i,storeKey:n}){super(t,{id:e,nextLine:s}),void 0===i&&(console.warn("set deafult question"),i="What do you want to share?"),this.question=i,this.storeKey=n}}class u extends c{constructor(t,{id:e,nextLine:s,message:i}){super(t,{id:e,nextLine:s}),void 0===i&&(console.warn("use default message"),i="MESSAGE"),this.message=i}}async function f(t){const e=await fetch("/story-lines/"+t);return function(t){const e=t.missions,s={};if(!e)return s;for(const t in e){const i=e[t];s[t]=n.fromDict(t,i)}return console.log(s),s}(await e.json())}class g{constructor(t,e,s,i,n,o,a){this.phaser=t,Number.isNaN(i)&&(i=0),Number.isNaN(n)&&(n=0),this.id=e,this.x=i,this.y=n,this._name=s,this.texture=o,this.frame=a,this.facing="DOWN",this.missionMark=null,this.makeContainer()}makeContainer(){this.player=this.phaser.physics.add.sprite(this.x,this.y,this.texture,this.frame).setSize(32,40).setOffset(0,24),this.text=this.phaser.add.text(this.x,this.y,this.name,{font:"18px monospace",fill:"#fff",align:"center"}).setOrigin(.5).setStroke("#000",3).setDepth(30)}get WIDTH(){return 32}get HEIGHT(){return 32}get SPEED(){return 256}get name(){return this._name}set name(t){this._name=t,this.text.setText(this.name)}showMissionMark(t){if(t){if(this.missionMark)return;this.missionMark=this.phaser.add.text(this.player.x,this.player.y-16,"!",{font:"24px monospace",fill:"#000",align:"center"}).setOrigin(.5).setStroke("#fff",3)}else this.missionMark.destroy(),this.missionMark=null}update(){this.text.setX(this.player.x),this.text.setY(this.player.y+45)}}class p{constructor(t){this.phaser=t,this.chars={}}create(t,e,s,i,n,o){if(t in this.chars)return console.error(`Character ID "${t}" is already declared:`),void console.error(this.chars[t]);const a=new g(this.phaser,t,e,s,i,n,o);return this.chars[t]=a,a}getChar(t){return t in this.chars?this.chars[t]:null}update(t,e){for(const s in this.chars){this.chars[s].update(t,e)}}}class m{constructor(t,e){this.storyLine=t,this.dialogDaemon=e,this.missionWithDependencies={},i.a.listen("*",()=>{console.log(this);for(const t in this.missionWithDependencies){const e=this.storyLine[t];e.isReady()&&(delete this.missionWithDependencies[t],this._addToDialogDaemon(e))}})}init(){for(const t in this.storyLine){const e=this.storyLine[t];e.isReady()?this._addToDialogDaemon(e):this.missionWithDependencies[t]=e}console.log("not enabled missions: ",this.missionWithDependencies)}_addToDialogDaemon(t){const e=t.firstStep,s=t.steps[e],i=`${t.id}/${s.id}`;this.dialogDaemon.add(i,s.npcId,s.dialog)}}const y=/\$player/;class D{constructor(t){this.charDaemon=t,this.dialogs={},this.hasOnGoingDialog=!1,this.dialogToTrigger=[]}showHint(){let t="";for(const e in this.dialogs){const s=this.dialogs[e];console.log(s),t+=`<h3>${s.dialog.missionStep.title}</h3>`,t+=`<p>${s.dialog.missionStep.description}</p>`}t||(t="沒有任務!"),bootbox.alert({title:"任務列表",message:t})}getDialog(t){return t in this.dialogs?this.dialogs[t]:null}showDialog(t){const e=t.getCurrentDialogItem();if(!e)return void this.doneDialog(t);this.hasOnGoingDialog=!0;const s=this.charDaemon.getChar("player"),i=e.name.replace(y,s.name);if(e instanceof l){const n=e.line.replace(y,s.name);bootbox.alert({title:i,message:n,callback:()=>{this.hasOnGoingDialog=!1;t.nextDialogItem()?this.showDialog(t):this.doneDialog(t)}})}else if(e instanceof h){const n=e.question.replace(y,s.name),o=[];for(const t in e.choices){const i=e.choices[t].text;o.push({text:i.replace(y,s.name),value:t})}bootbox.prompt({title:i,message:n,inputType:"select",onEscape:!1,backdrop:!0,inputOptions:o,callback:e=>{if(null===e)return!1;this.hasOnGoingDialog=!1;return t.nextDialogItem(e)?this.showDialog(t):this.doneDialog(t),!0}})}else if(e instanceof d){const n=e.question.replace(y,s.name);bootbox.prompt({title:i,message:n,inputType:"text",onEscape:!1,backdrop:!0,callback:e=>{if(null===e)return!1;this.hasOnGoingDialog=!1;return t.nextDialogItem(e)?this.showDialog(t):this.doneDialog(t),!0}})}else if(e instanceof u){const i=e.message.replace(y,s.name);bootbox.alert({title:"",message:i,callback:()=>{this.hasOnGoingDialog=!1;t.nextDialogItem()?this.showDialog(t):this.doneDialog(t)}})}}recordDone(t){i.a.setAndNotify(t,"true"),i.b.increase("MISSION/"+t)}doneDialog(t){const e=t.dialog.missionStep,s=e.mission;this.remove(`${s.id}/${e.id}`),this.recordDone(`${s.id}/${e.id}/done`);const i=t.nextStep;if(!i)return;console.log(i);const n=s.steps[i];n&&this.add(`${s.id}/${n.id}`,n.npcId,n.dialog)}moveTo(t){const e=this.charDaemon.getChar("player");switch(console.log(e),t){case"SCHOOL":e.player.x=500,e.player.y=500}}startDialog(t){if(this.hasOnGoingDialog)return void console.warn("There is an on-going dialog, cannot start a new one");const e=this.getDialog(t);if(null===e)return void console.error("No such dialog: "+t);console.info("startDialog: "+t,e.dialog);const{dialog:s}=e;s.missionStep.moveTo&&this.moveTo(s.missionStep.moveTo);const i=s.getIterator();this.showDialog(i)}checkDialogToTrigger(){if(this.hasOnGoingDialog)return null;for(const t in this.dialogToTrigger){const{dialogId:e}=this.dialogToTrigger[t];return this.dialogToTrigger.shift(),e}return null}findNearbyDialog(t){for(const e in this.dialogs){const{npcId:s}=this.dialogs[e],i=this.charDaemon.getChar(s);if(Math.hypot(i.x-t.x,i.y-t.y)<64)return e}return null}add(t,e,s){if(null===this.getDialog(t)){if(void 0===e)this.dialogToTrigger.push({dialogId:t,dialog:s});else{const t=this.charDaemon.getChar(e);if(null===t)return void console.error(`NPC ${e} doesn't exist.`);t.showMissionMark(!0)}return this.dialogs[t]={npcId:e,dialog:s},this.dialogs[t]}console.error(`Dialog ${t} already exists.`)}remove(t){const e=this.getDialog(t);if(null===e)return;const{npcId:s}=e,i=this.charDaemon.getChar(s);null!==i&&i.showMissionMark(!1),delete this.dialogs[t]}}const x={type:Phaser.AUTO,width:800,height:600,parent:"game-container",pixelArt:!0,physics:{default:"arcade",arcade:{gravity:{y:0}}},scene:{preload:function(){this.load.setPath("assets/"),this.load.image("tiles","tiles/world.png"),this.load.tilemapTiledJSON("map","maps/idystopia.json"),this.load.atlas("atlas","atlas/atlas.png","atlas/atlas.json")},create:function(){const t=this.make.tilemap({key:"map"}),e=t.addTilesetImage("world","tiles"),s=(t.createStaticLayer("Below Player",e,0,0),t.createStaticLayer("World",e,0,0)),n=t.createStaticLayer("Above Player",e,0,0);s.setCollisionByProperty({collides:!0}),n.setDepth(10);const o=t.findObject("Objects",t=>"Spawn Point"===t.name);this.charDaemon=new p(this);const a={"convenient-store-npc":{name:"便利商店店員",x:o.x+128,y:o.y-128,texture:"atlas",frame:"misa-left"},"classmate-npc":{name:"同學",x:600,y:550,texture:"atlas",frame:"misa-left"},"academic-affairs-officer-npc":{name:"教務處職員",x:700,y:550,texture:"atlas",frame:"misa-left"},"department-officer-npc":{name:"系辦公室職員",x:800,y:550,texture:"atlas",frame:"misa-right"},"home-robot-npc":{name:"家用機器人",x:400,y:550,texture:"atlas",frame:"misa-right"}};for(const t in a){if(!a.hasOwnProperty(t))continue;const{name:e,x:s,y:i,texture:n,frame:o}=a[t];this.charDaemon.create(t,e,s,i,n,o)}const r=this.charDaemon.create("player","???",o.x,o.y,"atlas","misa-front");w=r.player;const c=this.physics.add.group();for(const t in this.charDaemon.chars)if(this.charDaemon.chars.hasOwnProperty(t)){const e=this.charDaemon.chars[t].player;c.add(e),"player"!==t&&e.setImmovable(!0)}this.physics.add.collider(c,c),this.physics.add.collider(c,s),this.dialogDaemon=new D(this.charDaemon),i.a.clearAll(),f("regular.json").then(t=>{this.storyLineDaemon=new m(t,this.dialogDaemon),this.storyLineDaemon.init()}),i.a.listen("player_name",t=>{r.name=i.a.get("player_name")});const l=this.anims;l.create({key:"misa-left-walk",frames:l.generateFrameNames("atlas",{prefix:"misa-left-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1}),l.create({key:"misa-right-walk",frames:l.generateFrameNames("atlas",{prefix:"misa-right-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1}),l.create({key:"misa-front-walk",frames:l.generateFrameNames("atlas",{prefix:"misa-front-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1}),l.create({key:"misa-back-walk",frames:l.generateFrameNames("atlas",{prefix:"misa-back-walk.",start:0,end:3,zeroPad:3}),frameRate:10,repeat:-1});this.add.text(640,512,"Mission",{font:"18px monospace",fill:"#000",backgroundColor:"#fff",padding:{x:10,y:10}}).setScrollFactor(0).setDepth(30).setInteractive().on("pointerdown",()=>{this.dialogDaemon.showHint()});const h=this.cameras.main;h.startFollow(w),h.setBounds(0,0,t.widthInPixels,t.heightInPixels),k=this.input.keyboard.createCursorKeys();this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER).on("down",(t,e)=>{if(this.dialogDaemon.hasOnGoingDialog)return;const s=this.dialogDaemon.findNearbyDialog(w);null!==s&&this.dialogDaemon.startDialog(s)}),this.add.text(16,16,'Arrow keys to move\nPress "D" to show hitboxes',{font:"18px monospace",fill:"#000000",padding:{x:20,y:10},backgroundColor:"#ffffff"}).setScrollFactor(0).setDepth(30),this.input.keyboard.once("keydown_D",t=>{this.physics.world.createDebugGraphic();const e=this.add.graphics().setAlpha(.75).setDepth(20);s.renderDebug(e,{tileColor:null,collidingTileColor:new Phaser.Display.Color(243,134,48,255),faceColor:new Phaser.Display.Color(40,39,37,255)})})},update:function(t,e){const s=this.dialogDaemon.checkDialogToTrigger(w);if(null!==s)return void this.dialogDaemon.startDialog(s);const i=w.body.velocity.clone();w.body.setVelocity(0),k.left.isDown?w.body.setVelocityX(-175):k.right.isDown&&w.body.setVelocityX(175);k.up.isDown?w.body.setVelocityY(-175):k.down.isDown&&w.body.setVelocityY(175);w.body.velocity.normalize().scale(175),k.left.isDown?w.anims.play("misa-left-walk",!0):k.right.isDown?w.anims.play("misa-right-walk",!0):k.up.isDown?w.anims.play("misa-back-walk",!0):k.down.isDown?w.anims.play("misa-front-walk",!0):(w.anims.stop(),i.x<0?w.setTexture("atlas","misa-left"):i.x>0?w.setTexture("atlas","misa-right"):i.y<0?w.setTexture("atlas","misa-back"):i.y>0&&w.setTexture("atlas","misa-front"));this.charDaemon.update()}}};new Phaser.Game(x);let k,w}]);
//# sourceMappingURL=index.js.map