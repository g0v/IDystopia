!function(e){var a={};function t(r){if(a[r])return a[r].exports;var o=a[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var o in e)t.d(r,o,function(a){return e[a]}.bind(null,o));return r},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="",t(t.s=35)}({35:function(e,a){function t(){for(const e in map.layers)e.match(/^calculate_/)&&delete map.layers[e];map.layers._cols&&(map.cols=map.layers._cols),map.layers._rows&&(map.rows=map.layers._rows),$('[name="rows"]').val(map.rows),$('[name="cols"]').val(map.cols),$("#result").val(JSON.stringify(map.layers)),localStorage.setItem("config",JSON.stringify(map.layers)),calculateWallLayer()}Game.loadSample=function(){$.get("room.json",(function(e){map.layers=e,t()}),"json")},Game.load=function(){return[Loader.loadImage("tiles","sprite/open_tileset.png")]},Game.init=function(){Keyboard.SPACE=32,Keyboard.listenForEvents([Keyboard.LEFT,Keyboard.RIGHT,Keyboard.UP,Keyboard.DOWN,Keyboard.SPACE]),this.tileAtlas=Loader.getImage("tiles");gameCore.initCurrentUser(map,"cursor","teachers/Headmaster fmale"),this.camera=new Camera(map,512,512),this.camera.follow(gameCore.me)},Game.spaceClick=function(){const e=map.getCol(gameCore.me.x),a=map.getRow(gameCore.me.y);if("wall"==$('[name="layer"]:checked').val())map.layers.wall[a*map.cols+e]=!map.layers.wall[a*map.cols+e],t();else if($(".map-object.choosed").length){const r=$('[name="layer"]:checked').val(),o=$(".map-object.choosed").data("object");map.layers[r][a*map.cols+e]==o?map.layers[r][a*map.cols+e]=null:map.layers[r][a*map.cols+e]=o,t()}},Game.update=function(e){let a,t=0,r=0;Keyboard.isDown(Keyboard.LEFT)?(t=-1,a=1):Keyboard.isDown(Keyboard.RIGHT)?(t=1,a=2):Keyboard.isDown(Keyboard.UP)?(r=-1,a=3):Keyboard.isDown(Keyboard.DOWN)?(r=1,a=0):(a=gameCore.me.row,Game.isWayClick=!1),"result"==$('[name="layer"]:checked').val()?(gameCore.me.move(e,t,r),gameCore.me.row=a):!t&&!r||Game.isWayClick||(Game.isWayClick=!0,gameCore.me.x+=map.tsize*t,gameCore.me.x=map.getX(map.getCol(gameCore.me.x))+map.tsize/2,gameCore.me.y+=map.tsize*r,gameCore.me.y=map.getY(map.getRow(gameCore.me.y))+map.tsize/2,gameCore.me.move(e,0,0)),Keyboard.isDown(Keyboard.SPACE)?Game.isClick||(Game.spaceClick(),Game.isClick=!0):Game.isClick=!1,this.camera.update()},Game.drawBlackWall=function(){const e=Math.floor(this.camera.x/map.tsize),a=e+this.camera.width/map.tsize,t=Math.floor(this.camera.y/map.tsize),r=t+this.camera.height/map.tsize,o=-this.camera.x+e*map.tsize,l=-this.camera.y+t*map.tsize;for(let n=e;n<=a;n++)for(let a=t;a<=r;a++){const r=map.getTile("wall",n,a),m=(n-e)*map.tsize+o,c=(a-t)*map.tsize+l;!1!==r&&this.ctx.fillRect(Math.round(m),Math.round(c),map.tsize,map.tsize)}},Game.render=function(){let e=[];this.drawGroundLayer(),e=e.concat(this.getDrawingHeroes()),"result"==$('[name="layer"]:checked').val()?(e=e.concat(this.getDrawingWalls()),e=e.concat(this.getDrawingObjects())):"ground"==$('[name="layer"]:checked').val()||"wall"==$('[name="layer"]:checked').val()?(e=e.concat(this.getDrawingWalls().map((function(e){return e[3]=.5,e}))),e=e.concat(this.getDrawingObjects().map((function(e){return e[3]=.5,e})))):"object"==$('[name="layer"]:checked').val()&&(e=e.concat(this.getDrawingWalls().map((function(e){return e[3]=.5,e}))),e=e.concat(this.getDrawingObjects())),e=e.sort((function(e,a){return e[0]-a[0]})),e.map((function(e){Game.ctx.save(),"number"==typeof e[3]?Game.ctx.globalAlpha=e[3]:Game.ctx.globalAlpha=1,"function"==typeof e[1]?e[1].apply(null,e[2]):Game.ctx[e[1]](...e[2]),Game.ctx.restore()})),"wall"==$('[name="layer"]:checked').val()&&this.drawBlackWall(),this._drawGrid()}}});